<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <meta name="theme-color" content="#23358E" />
    <link rel="icon" href="https://infinity.500apps.com/favicon.webp" />
    <title>Signup status</title>
    <link rel="stylesheet" href="https://infinity.500apps.com/css/theme.css" />
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css" />
    <link rel="stylesheet" href="https://infinity.500apps.com/fonts/feather/feather.css" />

    <style>
        .table-sm th,
        .table-sm td {
            padding: 0.7rem 0.7rem 0.5rem 0.7rem !important;
        }

        .close-btn-right .close {
            margin-left: auto !important;
            margin-right: 0px !important;
        }

        .b-sidebar-body {
            padding: 20px !important;
        }

        .b-sidebar-header strong {
            font-size: 1rem;
        }

        .pie-chart-custom {
            display: block;
            width: 474px;
            height: 351px;
            padding-top: 101px;
        }

        .card-pagination .page-link {
            padding: 10px;
        }

        .card-table {
            margin-bottom: 20px !important;
        }

        .highcharts-figure,
        .highcharts-data-table table {
            min-width: 310px;
            max-width: 800px;
            margin: 1em auto;
        }

        #container {
            height: 400px;
        }

        .highcharts-data-table table {
            font-family: Verdana, sans-serif;
            border-collapse: collapse;
            border: 1px solid #ebebeb;
            margin: 10px auto;
            text-align: center;
            width: 100%;
            max-width: 500px;
        }

        .highcharts-data-table caption {
            padding: 1em 0;
            font-size: 1.2em;
            color: #555;
        }

        .highcharts-data-table th {
            font-weight: 600;
            padding: 0.5em;
        }

        .highcharts-data-table td,
        .highcharts-data-table th,
        .highcharts-data-table caption {
            padding: 0.5em;
        }

        .highcharts-data-table thead tr,
        .highcharts-data-table tr:nth-child(even) {
            background: #f8f8f8;
        }

        .highcharts-data-table tr:hover {
            background: #f1f7ff;
        }

        .width_320 {
            width: 320px;
        }

        .width_250 {
            width: 250px;
        }

        .b-form-btn-label-control.form-control>.form-control {
            white-space: nowrap !important;
        }

        .form-control {
            padding-right: 24px !important;
        }

        .b-calendar .b-calendar-grid {
            padding-right: 0px !important;
        }

        .highcharts-container {
            width: 1000px;
        }

        .highcharts-figure,
        .highcharts-data-table table {
            max-width: 1000px;
        }

        .min-height-60vh {
            min-height: 60vh;
        }

        @media (max-width: 567px) {
            .width_320 {
                width: auto !important;
            }

            .mobile-border {
                border-top: 1px solid #e3ebf6;
            }

            .min-height-60vh {
                min-height: auto !important;
            }
        }

        @media (max-width: 992px) {
            .width_320 {
                width: auto !important;
            }

            .mobile-border {
                border-top: 1px solid #e3ebf6;
            }

            .min-height-60vh {
                min-height: auto !important;
            }

            .padding-20 {
                padding: 20px 15px !important;
            }
        }

        text.highcharts-title {
            text-transform: capitalize !important;
        }

        .p-mb-0 p {
            margin-bottom: 0px;
        }

        .border-bottom-1px {
            border-bottom: 1px dashed #edf2f9 !important;
        }

        .last-child-border-bottom .border-bottom-1px:last-child {
            border-bottom: 0px !important;
            margin-bottom: 0px !important;
            padding-bottom: 0px !important;
        }

        .cursor-pointer {
            cursor: pointer;
        }

        .icons-small-desktop,
        .icons-small-mobile {
            display: inline-block;
            background: url("https://infinity.500apps.com/img/flags/devices-small.png") no-repeat;
            overflow: hidden;
            text-indent: -9999px;
            text-align: left;
        }

        .icons-small-desktop {
            background-position: -1px -0;
            width: 12px;
            height: 11px;
        }

        .icons-small-mobile {
            background-position: -1px -12px;
            width: 7px;
            height: 11px;
        }

        .bg-ie,
        .bg-android,
        .bg-AD,
        .bg-AE,
        .bg-AF,
        .bg-AG,
        .bg-AI,
        .bg-AL,
        .bg-AM,
        .bg-AO,
        .bg-AQ,
        .bg-AR,
        .bg-AS,
        .bg-AT,
        .bg-AU,
        .bg-AW,
        .bg-A,
        .bg-AZ,
        .bg-BA,
        .bg-BB,
        .bg-BD,
        .bg-BE,
        .bg-BF,
        .bg-BG,
        .bg-BH,
        .bg-BI,
        .bg-BJ,
        .bg-BL,
        .bg-BM,
        .bg-BN,
        .bg-BO,
        .bg-BQ,
        .bg-BR,
        .bg-BS,
        .bg-BT,
        .bg-BV,
        .bg-BW,
        .bg-BY,
        .bg-BZ,
        .bg-CA,
        .bg-CC,
        .bg-CD,
        .bg-CF,
        .bg-CG,
        .bg-CH,
        .bg-CK,
        .bg-CL,
        .bg-CM,
        .bg-CN,
        .bg-CO,
        .bg-CR,
        .bg-CU,
        .bg-CV,
        .bg-CW,
        .bg-C,
        .bg-CY,
        .bg-CZ,
        .bg-DE,
        .bg-DJ,
        .bg-DK,
        .bg-DM,
        .bg-DO,
        .bg-DZ,
        .bg-EC,
        .bg-EE,
        .bg-EG,
        .bg-EH,
        .bg-ER,
        .bg-ES,
        .bg-ET,
        .bg-FI,
        .bg-FJ,
        .bg-FK,
        .bg-FM,
        .bg-FO,
        .bg-FR,
        .bg-GA,
        .bg-GB,
        .bg-GD,
        .bg-GE,
        .bg-GF,
        .bg-GG,
        .bg-GH,
        .bg-GI,
        .bg-GL,
        .bg-GM,
        .bg-GN,
        .bg-GP,
        .bg-GQ,
        .bg-GR,
        .bg-GS,
        .bg-GT,
        .bg-GU,
        .bg-GW,
        .bg-GY,
        .bg-HK,
        .bg-HM,
        .bg-HN,
        .bg-HR,
        .bg-HT,
        .bg-HU,
        .bg-ID,
        .bg-IE,
        .bg-IL,
        .bg-IM,
        .bg-IN,
        .bg-IO,
        .bg-IQ,
        .bg-IR,
        .bg-IS,
        .bg-IT,
        .bg-JE,
        .bg-JM,
        .bg-JO,
        .bg-JP,
        .bg-KE,
        .bg-KG,
        .bg-KH,
        .bg-KI,
        .bg-KM,
        .bg-KN,
        .bg-KP,
        .bg-KR,
        .bg-KW,
        .bg-KY,
        .bg-KZ,
        .bg-LA,
        .bg-LB,
        .bg-LC,
        .bg-LI,
        .bg-LK,
        .bg-LR,
        .bg-LS,
        .bg-LT,
        .bg-LU,
        .bg-LV,
        .bg-LY,
        .bg-MA,
        .bg-MC,
        .bg-MD,
        .bg-ME,
        .bg-MF,
        .bg-MG,
        .bg-MH,
        .bg-MK,
        .bg-ML,
        .bg-MM,
        .bg-MN,
        .bg-MO,
        .bg-MQ,
        .bg-MR,
        .bg-MS,
        .bg-MT,
        .bg-MU,
        .bg-MV,
        .bg-M,
        .bg-MZ,
        .bg-NA,
        .bg-NE,
        .bg-NF,
        .bg-NG,
        .bg-NI,
        .bg-NL,
        .bg-NO,
        .bg-NP,
        .bg-NR,
        .bg-NU,
        .bg-NZ,
        .bg-OM,
        .bg-PA,
        .bg-PE,
        .bg-PF,
        .bg-PG,
        .bg-PH,
        .bg-PK,
        .bg-PL,
        .bg-PM,
        .bg-PN,
        .bg-PR,
        .bg-PS,
        .bg-PT,
        .bg-PW,
        .bg-PY,
        .bg-QA,
        .bg-RE,
        .bg-RO,
        .bg-RS,
        .bg-RU,
        .bg-RW,
        .bg-SA,
        .bg-SB,
        .bg-SC,
        .bg-SD,
        .bg-SE,
        .bg-SG,
        .bg-SH,
        .bg-SI,
        .bg-SJ,
        .bg-SK,
        .bg-SL,
        .bg-SM,
        .bg-SN,
        .bg-SO,
        .bg-SR,
        .bg-ST,
        .bg-SV,
        .bg-S,
        .bg-SY,
        .bg-TC,
        .bg-TD,
        .bg-TF,
        .bg-TG,
        .bg-TH,
        .bg-TJ,
        .bg-TK,
        .bg-TL,
        .bg-TM,
        .bg-TN,
        .bg-TO,
        .bg-TR,
        .bg-TT,
        .bg-TV,
        .bg-TW,
        .bg-TZ,
        .bg-UA,
        .bg-UG,
        .bg-UM,
        .bg-US,
        .bg-UY,
        .bg-UZ,
        .bg-VC,
        .bg-VE,
        .bg-VG,
        .bg-VI,
        .bg-VN,
        .bg-VU,
        .bg-WF,
        .bg-WS,
        .bg-YE,
        .bg-YT,
        .bg-ZA,
        .bg-ZM,
        .bg-ZW {
            background: url("https://infinity.500apps.com/img/flags/flags-big.png") no-repeat;
            display: inline-block;
        }

        .bg-IN {
            width: 20px;
            height: 20px;
            background-position: -305px -95px;
        }

        .b-sidebar-body.script-p-0 {
            padding: 0px !important;
        }
    </style>
</head>

<body>
    <div id="signup">
        <b-navbar class="px-5 py-3 navbar-vibrant" type="dark">
            <b-navbar-brand href="#">
                <b-img src="https://500apps.com/images/500_apps_logo.svg"></b-img>
            </b-navbar-brand>
        </b-navbar>
        <div class="container-fluid mt-md-5 mt-3">
            <div class="card mx-lg-5 mx-md-3">
                <b-tabs nav-class="ml-4" content-class="mt-3 px-4 row mx-0">
                    <b-tab title="Reports" active @click="resetDates()">
                        <div>
                            <div class="row mx-0">
                                <div
                                    class="bg-light col-12 d-md-block d-lg-flex d-block justify-content-between px-3 padding-20 align-items-center">
                                    <h2 class="font-weight-bold mb-0 text-nowrap">SignUp Reports</h2>
                                    <div class="d-lg-flex d-md-flex d-block py-2">
                                        <div class="my-1 width_320">
                                            <b-form-group class="mb-0" label-class="text-lg-right text-left"
                                                content-class="px-0" label-cols-lg="6" content-cols-lg="6"
                                                content-cols-md="12" content-cols="12" label="Region">
                                                <b-form-select v-model="region" :options="regions"
                                                    @change="generateReport()"></b-form-select>
                                            </b-form-group>
                                        </div>
                                        <div class="my-1 width_330">
                                            <b-form-group label-cols-lg="2" content-cols-lg="10" content-cols="12"
                                                label-class="text-lg-right text-left" content-class="px-0"
                                                content-cols-md="12" class="px-md-1 mb-0" id="input-group-1"
                                                label="From" label-for="input-5" class="mb-0">
                                                <b-form-datepicker id="input-5" class="border" v-model="fromDate"
                                                    locale="en" @input="dateSelected()" type="date" required
                                                    placeholder="From date"></b-form-datepicker>
                                            </b-form-group>
                                        </div>
                                        <div class="ml-lg-n4 ml-md-n2 my-1 pl-md-1 width_330">
                                            <b-form-group label-class="text-lg-right text-left" content-class="px-0"
                                                label-cols-lg="2" content-cols="12" content-cols-lg="10"
                                                content-cols-md="12" class="px-md-1 mb-0" id="input-group-2" label="To"
                                                label-for="input-5" class="mb-0">
                                                <b-form-datepicker id="input-end-date" class="border" v-model="toDate"
                                                    :min="fromDate" locale="en"
                                                    @input="generateReport();pieChartData();reportsByCategory()"
                                                    type="date" :max="maxDate" required placeholder="To date"
                                                    :disabled="!fromDate">
                                                </b-form-datepicker>
                                            </b-form-group>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="row mx-0 mx-lg-3">
                                    <b-col v-if="emptyState"
                                        class="col-7 col-md-12 col-12 pr-5 text-center min-height-60vh">
                                        <img width="320" class="pt-6"
                                            src="https://infinity.500apps.com/img/empty-states/projectsly/no-reports.svg" />
                                        <h3 class="font-weight-bold pt-4 mb-2" style="font-size: 20px">No data available
                                        </h3>
                                        <p style="font-size: 16px">Kindly change the date range and try again</p>
                                    </b-col>
                                    <b-col v-if="!emptyState" lg="7" md="12" class="py-lg-5 py-3 px-0 min-height-60vh">
                                        <!-- <div class="d-flex justify-content-center"></div> -->
                                        <figure class="highcharts-figure">
                                            <div id="container-highcharts"></div>
                                        </figure>
                                    </b-col>

                                    <b-col lg="5" md="12" class="py-lg-5 pb-3 pt-1 px-0">
                                        <div id="app" class="mobile-border">
                                            <figure class="highcharts-figure">
                                                <div id="container-pie"></div>
                                            </figure>
                                        </div>
                                    </b-col>
                                </div>

                                <div class="row mx-0 mx-lg-3">
                                    <b-col lg="6" class="py-lg-5 py-3 px-0 min-height-60vh" v-if="!hideDeviceReport">
                                        <figure class="highcharts-figure">
                                            <div id="container-pie-device_type"></div>
                                        </figure>
                                    </b-col>

                                    <b-col lg="6" class="py-lg-5 py-3 px-0 min-height-60vh" v-if="!hideAppsReport">
                                        <figure class="highcharts-figure">
                                            <div id="container-pie-app_name"></div>
                                        </figure>
                                    </b-col>

                                    <b-col lg="6" class="py-lg-5 py-3 px-0 min-height-60vh" v-if="!hideBrowserReport">
                                        <figure class="highcharts-figure">
                                            <div id="container-pie-browser_type"></div>
                                        </figure>
                                    </b-col>
                                    <b-col lg="6" class="py-lg-5 py-3 px-0 min-height-60vh" v-if="!hideCountryReport">
                                        <figure class="highcharts-figure">
                                            <div id="container-pie-country"></div>
                                        </figure>
                                    </b-col>
                                    <b-col lg="6" class="py-lg-5 py-3 px-0 min-height-60vh" v-if="!hideAuthReport">
                                        <figure class="highcharts-figure">
                                            <div id="container-pie-auth_type"></div>
                                        </figure>
                                    </b-col>
                                    <b-col lg="6" class="py-lg-5 py-3 px-0 min-height-60vh">
                                        <figure class="highcharts-figure">
                                            <div id="container-pie-app_wise_users"></div>
                                        </figure>
                                    </b-col>
                                    <b-col lg="6" class="py-lg-5 py-3 px-0 min-height-60vh">
                                        <figure class="highcharts-figure">
                                            <div id="container-pie-domain_wise"></div>
                                        </figure>
                                    </b-col>
                                </div>

                                <b-overlay :show="isBusy" no-wrap opacity="0.5" spinner-variant="primary"></b-overlay>
                            </div>
                        </div>
                    </b-tab>
                    <!-- Signup Comparisons -->
                    <b-tab title="Signup Comparisons" @click="showComparisions()">
                        <!-- All countries line chart  -->
                        <div class="row mx-0 mx-lg-3">
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-line-all"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- All countries line chart  -->

                            <!-- Us east countries line chart  -->
                            <b-col lg="12" class="py-lg-5 pb-3 pt-1 px-0">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-line-us1"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- Us east countries line chart  -->

                            <!-- Us west countries line chart  -->
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-line-us2"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- Us west countries line chart  -->

                            <!-- Europe  countries line chart  -->
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-line-eu1"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- Europe  countries line chart  -->

                            <!-- Asia  countries line chart  -->
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-line-ap1"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- Asia  countries line chart  -->

                            <!-- Australia  countries line chart  -->
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-line-ap2"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- Australia  countries line chart  -->

                            <!-- South-America  countries line chart  -->
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-line-sa1"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- South-America  countries line chart  -->
                        </div>
                        <b-overlay :show="isComparisionLoading" no-wrap opacity="0.5" spinner-variant="primary">
                        </b-overlay>
                    </b-tab>
                    <b-tab title="App Wise Comparision" @click="showComparisions('signup')">
                        <b-row>
                            <b-col v-if="showAllAppsOnce" cols="12" class="py-lg-5 py-3 px-0 min-height-60vh">
                                <div class="row">
                                    <div lg="6" v-for="app_name in appsList" class="col-6 p-3">
                                        <figure class="highcharts-figure card p-3">
                                            <div :id="`container-signup-${app_name}`"></div>
                                        </figure>
                                    </div>
                                </div>
                            </b-col>
                            <b-overlay :show="isBusy" no-wrap opacity="0.5" spinner-variant="primary"></b-overlay>
                        </b-row>
                    </b-tab>
                    <!-- Signup Comparisons ends  -->
                    <b-tab title="Traffic" class="w-100" @click="resetDates('analytics')">
                        <div class="row mx-0">
                            <div
                                class="bg-light col-12 d-md-block d-lg-flex d-block justify-content-between px-3 padding-20 align-items-center">
                                <h2 class="font-weight-bold mb-0 text-nowrap">GA4 Reports</h2>
                                <div class="d-lg-flex d-md-flex d-block py-2">
                                    <div class="my-1 width_330 text-lg-right">
                                        <b-form-group label-cols-lg="2" content-cols-lg="10" content-cols="12"
                                            label-class="text-lg-right text-left" content-class="px-0"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-1" label="From"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-5-analytic" class="border" v-model="fromDate"
                                                locale="en" @input="dateSelected()" type="date" required
                                                placeholder="From date"></b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                    <div class="ml-lg-n4 ml-md-n2 my-1 pl-md-1 width_330">
                                        <b-form-group label-class="text-lg-right text-left" content-class="px-0"
                                            label-cols-lg="2" content-cols="12" content-cols-lg="10"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-2" label="To"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-end-date-analytic" class="border"
                                                v-model="toDate" :min="fromDate" locale="en"
                                                @input="generateBarAnalytics()" type="date" :max="maxDate" required
                                                placeholder="To date" :disabled="!fromDate">
                                            </b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <div class="row mx-0 mx-lg-3">
                                <b-col v-if="emptyState"
                                    class="col-12 col-md-12 col-12 pr-5 text-center min-height-60vh">
                                    <img width="320" class="pt-6"
                                        src="https://infinity.500apps.com/img/empty-states/projectsly/no-reports.svg" />
                                    <h3 class="font-weight-bold pt-4 mb-2" style="font-size: 20px">No data available
                                    </h3>
                                    <p style="font-size: 16px">Kindly change the date range and try again</p>
                                </b-col>

                                <b-col v-if="!emptyState" lg="12" md="12" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <!-- <div class="d-flex justify-content-center"></div> -->
                                    <figure class="highcharts-figure">
                                        <div id="container-bar-analytics-date"></div>
                                    </figure>
                                </b-col>
                                <b-col v-if="!emptyState" lg="6" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <figure class="highcharts-figure">
                                        <div id="container-pie-analytics-app"></div>
                                    </figure>
                                </b-col>
                                <b-col v-if="!emptyState" lg="6" md="12" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <figure class="highcharts-figure">
                                        <div id="container-pie-analytics-country"></div>
                                    </figure>
                                </b-col>
                                <b-col v-if="!emptyState" lg="12" md="12" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <figure class="highcharts-figure">
                                        <div id="container-pie-analytics-sessionMedium"></div>
                                    </figure>
                                </b-col>
                                <b-tabs nav-class="ml-4" content-class="mt-3 px-4 row mx-0">
                                    <b-tab title="Date Wise" active @click="getListOfAppsAtOnce()">
                                        <b-row>
                                            <b-col v-if="showAllAppsOnce" cols="12"
                                                class="py-lg-5 py-3 px-0 min-height-60vh">
                                                <div class="row">
                                                    <div v-if="!emptyState" lg="6" v-for="app_name in appsList"
                                                        class="col-6 p-3">
                                                        <figure class="highcharts-figure card p-3">
                                                            <div :id="`container-analytics-${app_name}`"></div>
                                                        </figure>
                                                    </div>
                                                </div>
                                            </b-col>
                                        </b-row>
                                    </b-tab>
                                    <b-tab title="Session Source" @click="getListOfAppsAtOnce('sessionSource')">
                                        <b-row>
                                            <b-col v-if="showAllAppsOnce" cols="12"
                                                class="py-lg-5 py-3 px-0 min-height-60vh">
                                                <div class="row">
                                                    <div v-if="!emptyState" lg="6" v-for="app_name in appsList"
                                                        class="col-12 p-3">
                                                        <figure class="highcharts-figure card p-3">
                                                            <div :id="`container-sessionSource-${app_name}`"></div>
                                                        </figure>
                                                    </div>
                                                </div>
                                            </b-col>
                                        </b-row>
                                    </b-tab>
                                </b-tabs>
                            </div>
                        </div>
                        <b-overlay :show="isBusy" no-wrap opacity="0.5" spinner-variant="primary"></b-overlay>
                    </b-tab>
                    <b-tab title="Traffic Comparisons" class="w-100" @click="showComparisions('analytics')">
                        <div class="row mx-0 mx-lg-3">
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0" v-if="!hideDeviceReport">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-analytics-all"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- All countries analytics chart  -->

                            <!-- Us east countries analytics chart  -->
                            <b-col lg="12" class="py-lg-5 pb-3 pt-1 px-0" v-if="!hideDeviceReport">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-analytics-AS"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- Us east countries analytics chart  -->

                            <!-- Us east countries analytics chart  -->
                            <b-col lg="12" class="py-lg-5 pb-3 pt-1 px-0" v-if="!hideDeviceReport">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-analytics-AF"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- Us east countries analytics chart  -->

                            <!-- Us west countries analytics chart  -->
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0" v-if="!hideDeviceReport">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-analytics-EU"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- Us west countries analytics chart  -->

                            <!-- Europe  countries analytics chart  -->
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0" v-if="!hideDeviceReport">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-analytics-NA"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- Europe  countries analytics chart  -->

                            <!-- Asia  countries analytics chart  -->
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0" v-if="!hideDeviceReport">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-analytics-SA"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- Asia  countries analytics chart  -->

                            <!-- Australia  countries analytics chart  -->
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0" v-if="!hideDeviceReport">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-analytics-OC"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- Australia  countries analytics chart  -->

                            <!-- South-America  countries analytics chart  -->
                            <b-col lg="12" md="12" class="py-lg-5 pb-3 pt-1 px-0" v-if="!hideDeviceReport">
                                <div id="app" class="mobile-border">
                                    <figure class="highcharts-figure">
                                        <div id="container-analytics-AN"></div>
                                    </figure>
                                </div>
                            </b-col>
                            <!-- South-America  countries analytics chart  -->
                        </div>
                        <b-overlay :show="isComparisionLoading" no-wrap opacity="0.5" spinner-variant="primary">
                        </b-overlay>
                    </b-tab>
                    <!-- NinjaContent Tab -->
                    <b-tab title="NinjaContent" class="w-100" @click="resetDates('ninjacontent')">
                        <div class="row mx-0">
                            <div
                                class="bg-light col-12 d-md-block d-lg-flex d-block justify-content-between px-3 padding-20 align-items-center">
                                <h2 class="font-weight-bold mb-0 text-nowrap">NinjaContent Reports</h2>
                                <div class="d-lg-flex d-md-flex d-block py-2">
                                    <div class="my-1 width_330 text-lg-right">
                                        <b-form-group label-cols-lg="2" content-cols-lg="10" content-cols="12"
                                            label-class="text-lg-right text-left" content-class="px-0"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-1" label="From"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-5-analytic" class="border" v-model="fromDate"
                                                locale="en" @input="dateSelected()" type="date" required
                                                placeholder="From date"></b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                    <div class="ml-lg-n4 ml-md-n2 my-1 pl-md-1 width_330">
                                        <b-form-group label-class="text-lg-right text-left" content-class="px-0"
                                            label-cols-lg="2" content-cols="12" content-cols-lg="10"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-2" label="To"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-end-date-analytic" class="border"
                                                v-model="toDate" :min="fromDate" locale="en"
                                                @input="showContentReports()" type="date" :max="maxDate" required
                                                placeholder="To date" :disabled="!fromDate">
                                            </b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <div class="row mx-0 mx-lg-3">
                                <b-col v-if="emptyState"
                                    class="col-12 col-md-12 col-12 pr-5 text-center min-height-60vh">
                                    <img width="320" class="pt-6"
                                        src="https://infinity.500apps.com/img/empty-states/projectsly/no-reports.svg" />
                                    <h3 class="font-weight-bold pt-4 mb-2" style="font-size: 20px">No data available
                                    </h3>
                                    <p style="font-size: 16px">Kindly change the date range and try again</p>
                                </b-col>

                                <b-col lg="6" md="12" v-if="!hideLiveConent" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <!-- <div class="d-flex justify-content-center"></div> -->
                                    <figure class="highcharts-figure">
                                        <div id="container-pie-ninjacontent-live_contents"></div>
                                    </figure>
                                </b-col>
                                <b-col lg="6" v-if="!hideDistributionStats" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <figure class="highcharts-figure">
                                        <div id="container-pie-ninjacontent-distribution_stats"></div>
                                    </figure>
                                </b-col>
                            </div>
                        </div>
                        <div>
                            <b-table v-if="hideContentURlsList" striped hover :items="contentUrls"></b-table>
                        </div>
                        <b-overlay :show="isBusy || loadContentData " no-wrap opacity="0.5" spinner-variant="primary">
                        </b-overlay>
                    </b-tab>
                    <!-- NinjaSEO Tab -->
                    <b-tab title="NinjaSEO" class="w-100" @click="resetDates('ninjaseo')">
                        <!-- Ninjaseo Header -->
                        <div class="row mx-0">
                            <div
                                class="bg-light col-12 d-md-block d-lg-flex d-block justify-content-between px-3 padding-20 align-items-center">
                                <h2 class="font-weight-bold mb-0 text-nowrap">NinjaSEO Reports</h2>
                                <div class="d-lg-flex d-md-flex d-block py-2">
                                    <div class="my-1 width_330 text-lg-right">
                                        <b-form-group label-cols-lg="2" content-cols-lg="10" content-cols="12"
                                            label-class="text-lg-right text-left" content-class="px-0"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-1" label="From"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-5-analytic" class="border" v-model="fromDate"
                                                locale="en" @input="dateSelected()" type="date" required
                                                placeholder="From date"></b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                    <div class="ml-lg-n4 ml-md-n2 my-1 pl-md-1 width_330">
                                        <b-form-group label-class="text-lg-right text-left" content-class="px-0"
                                            label-cols-lg="2" content-cols="12" content-cols-lg="10"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-2" label="To"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-end-date-analytic" class="border"
                                                v-model="toDate" :min="fromDate" locale="en" @input="showSEOReports()"
                                                type="date" :max="maxDate" required placeholder="To date"
                                                :disabled="!fromDate">
                                            </b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Ninjaseo Graphs -->
                        <div>
                            <div class="row mx-0 mx-lg-3">
                                <b-col v-if="emptyState"
                                    class="col-12 col-md-12 col-12 pr-5 text-center min-height-60vh">
                                    <img width="320" class="pt-6"
                                        src="https://infinity.500apps.com/img/empty-states/projectsly/no-reports.svg" />
                                    <h3 class="font-weight-bold pt-4 mb-2" style="font-size: 20px">No data available
                                    </h3>
                                    <p style="font-size: 16px">Kindly change the date range and try again</p>
                                </b-col>

                                <b-col lg="6" md="12" v-if="!hidePageGrader" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <figure class="highcharts-figure">
                                        <div id="container-pie-ninjaseo-page_grader"></div>
                                    </figure>
                                </b-col>
                                <b-col lg="6" v-if="!hideLinkTracking" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <figure class="highcharts-figure">
                                        <div id="container-pie-ninjaseo-link_tracking"></div>
                                    </figure>
                                </b-col>
                                <b-col lg="12" v-if="!hideRankings" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <figure class="highcharts-figure">
                                        <div id="container-pie-ninjaseo-rankings"></div>
                                        <div class="border rounded">
                                            <b-row class="pr-2 pt-4" v-if="RankingsDomainCount">
                                                <b-col lg="3" class="text-center">
                                                    <h4>Unique Keyword Count</h4>
                                                    <p class="h2">{{RankingsKeywordCount}}</p>
                                                </b-col>
                                                <b-col lg="3" class="text-center">
                                                    <h4>Domain Count</h4>
                                                    <p class="h2">{{RankingsDomainCount}}</p>
                                                </b-col>
                                                <b-col lg="3" class="text-center">
                                                    <h4>Position Rank Below 100</h4>
                                                    <p class="h2">
                                                        {{`${seoStatistics.below_100.length}(${getPercentage(seoStatistics.below_100)}%)`}}
                                                    </p>
                                                </b-col>
                                                <b-col lg="3" class="text-center">
                                                    <h4>Position Rank Below 50</h4>
                                                    <p class="h2">
                                                        {{`${seoStatistics.below_50.length}(${getPercentage(seoStatistics.below_50)}%)`}}
                                                    </p>
                                                </b-col>
                                                <b-col lg="3" class="text-center">
                                                    <h4>Position Rank Below 25</h4>
                                                    <p class="h2">
                                                        {{`${seoStatistics.below_25.length}(${getPercentage(seoStatistics.below_25)}%)`}}
                                                    </p>
                                                </b-col>
                                                <b-col lg="3" class="text-center">
                                                    <h4>Position Rank Below 10</h4>
                                                    <p class="h2">
                                                        {{`${seoStatistics.below_10.length}(${getPercentage(seoStatistics.below_10)}%)`}}
                                                    </p>
                                                </b-col>
                                                <b-col lg="3" class="text-center">
                                                    <h4>Position Rank Below 5</h4>
                                                    <p class="h2">
                                                        {{`${seoStatistics.below_5.length}(${getPercentage(seoStatistics.below_5)}%)`}}
                                                    </p>
                                                </b-col>
                                            </b-row>
                                            <b-row v-else class="text-center">
                                                <b-col class="m-5">
                                                    <b-spinner variant="primary"></b-spinner>
                                                </b-col>
                                            </b-row>
                                        </div>
                                    </figure>
                                </b-col>
                            </div>
                        </div>
                        <!-- Ninjaseo Table -->
                        <div>
                            <b-tabs v-on:activate-tab="seoTabActivated">
                                <b-tab :id="app.value" :title="app.text" v-for="app in ninjaSEOList">
                                    <div v-if="seoTableData[app.value] && seoTableData[app.value].length"
                                        style="overflow-y: auto !important;height: 600px !important;"
                                        @scroll="onScroll($event, app.value)">
                                        <div class="d-flex justify-content-end my-3">
                                            <b-button :variant="!accordionVisible[app.value]?'primary':'warning'"
                                                @click="accordionVisible[app.value]=!accordionVisible[app.value]"
                                                v-if="seoTableData[app.value].length">
                                                {{accordionVisible[app.value]?'Close All':'Open All'}}
                                            </b-button>
                                        </div>
                                        <div v-for="item in seoTableData[app.value]">
                                            <div v-if="item[0]">
                                                <b-card-header header-tag="header" class="p-0 height-50" role="tab">
                                                    <b-button v-b-toggle="`collapse-${item[0].id}`" variant="white"
                                                        class="text-left">
                                                        <img :src="getAppLogo(app.value, item[0])"
                                                            class="rounded-circle" width="30" height="30" />
                                                        {{getAppName(app.value, item[0])}}
                                                    </b-button>
                                                </b-card-header>
                                                <div>
                                                    <b-collapse :id="`collapse-${item[0].id}`"
                                                        :visible="accordionVisible[app.value]">
                                                        <b-table striped hover :fields="getTableFields(app.value)"
                                                            :items="item" class="table-sm">
                                                            <template #cell(is_success)="data">
                                                                {{ data.value ? JSON.parse(data.value).length + "/" +
                                                                (parseInt(JSON.parse(data.value).length) +
                                                                parseInt(JSON.parse(data.item.is_failure).length)) :
                                                                "--" }}
                                                            </template>
                                                            <template #cell(history)="data">
                                                                <b-link @click="showHistory(data.item)"
                                                                    v-b-toggle.history_sidebar>
                                                                    History</b-link>
                                                            </template>
                                                            <template #cell(created_date)="data">
                                                                {{moment(data.value).fromNow()}}
                                                            </template>
                                                            <template #cell(updated_date)="data">
                                                                {{moment(data.value).fromNow()}}
                                                            </template>
                                                            <template #cell(position_url)="data">
                                                                {{data.value || '--'}}
                                                            </template>
                                                            <template #cell(keyword_position)="data">
                                                                {{data.value || '--'}}
                                                                <span
                                                                    v-if="positionStatus(data.item) && positionStatus(data.item).search('increased') !== -1">
                                                                    (<span class="fe fe-arrow-up text-success"
                                                                        :id="'increased-tooltip-' + data.item.id">{{
                                                                        positionStatus(data.item).split(" ")[2] }}
                                                                        <b-tooltip
                                                                            :target="'increased-tooltip-' + data.item.id"
                                                                            triggers="hover">
                                                                            <span
                                                                                class="fe fe-arrow-up text-success"></span>{{
                                                                            positionStatus(data.item) }}
                                                                        </b-tooltip>
                                                                    </span>)
                                                                </span>
                                                                <span
                                                                    v-else-if="positionStatus(data.item) && positionStatus(data.item).search('increased') !== -1">
                                                                    (<span class="fe fe-arrow-down text-danger"
                                                                        :id="'decreased-tooltip-' + data.item.id">{{
                                                                        positionStatus(data.item).split(" ")[2] }}
                                                                        <b-tooltip
                                                                            :target="'decreased-tooltip-' + data.item.id"
                                                                            triggers="hover">
                                                                            <span
                                                                                class="fe fe-arrow-down text-danger"></span>{{
                                                                            positionStatus(data.item) }}
                                                                        </b-tooltip>
                                                                    </span>)
                                                                </span>
                                                            </template>
                                                            <template #cell(payment_amount)="data">
                                                                {{data.value || '--'}}
                                                            </template>
                                                            <template #cell(notes)="data">
                                                                <b-link @click="showHistory(data.item, 'notes')"
                                                                    v-b-toggle.history_sidebar>Notes
                                                                </b-link>
                                                            </template>
                                                            <template #cell(activity)="data">
                                                                <b-link @click="showHistory(data.item, 'activities')"
                                                                    v-b-toggle.history_sidebar>
                                                                    Activities</b-link>
                                                            </template>
                                                        </b-table>
                                                    </b-collapse>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <b-card v-else>
                                        <h1>Please try with different dates</h1>
                                    </b-card>
                                </b-tab>
                            </b-tabs>
                        </div>

                        <b-overlay :show="isBusy || loadContentData " no-wrap opacity="0.5" spinner-variant="primary">
                        </b-overlay>
                        <b-sidebar id="history_sidebar"
                            :title="seoPageType==='link_tracking'?'Link Trackings': 'Keyword History'" width="40%"
                            sidebar-class="border-left " right shadow body-class="bg-soft-light"
                            header-class="bg-white border-bottom d-flex flex-row-reverse justify-content-between  close-btn-right"
                            responsive :lazy="true" @hidden="resetHistory()">
                            <div v-if="pageGraderHistory.length && seoPageType==='page_grader'">
                                <b-card no-body v-for="(history, index) in pageGraderHistory" :key="index"
                                    class="shadow-none mb-3">
                                    <b-card-header>
                                        <p class="mb-0 text-truncate">
                                            {{ history.link_url }}/{{ history.keyword }} -
                                        </p>
                                        <span :id="'score-tooltip-' + history.id"
                                            :class="history.score < 50 ? 'text-danger' : history.score < 90 ? 'text-warning' : 'text-success'">{{
                                            history.score }}</span>
                                        <p class="mb-0 ml-2 text-right">
                                            {{moment(history.created_date).fromNow()}}
                                        </p>
                                    </b-card-header>
                                    <b-card-body>
                                        <div>
                                            <b-button block v-b-toggle="`rules-success-${index}`" variant="white"
                                                class="block mb-2"><span class="text-success"> Success</span></b-button>
                                            <b-collapse :id="'rules-success-'+index" accordion="my-accordion-1"
                                                role="tabpanel">
                                                <div class="list-group my-3">
                                                    <div class="list-group-item"
                                                        v-for="item in JSON.parse(history.is_success)">{{item.message}}
                                                    </div>
                                                </div>
                                            </b-collapse>
                                        </div>
                                        <div>
                                            <b-button block v-b-toggle="`rules-failure-${index}`" variant="white"
                                                class="block"><span class="text-danger">Failure</span></b-button>
                                            <b-collapse :id="'rules-failure-'+index" accordion="my-accordion-2"
                                                role="tabpanel">
                                                <div class="list-group my-3">
                                                    <div class="list-group-item"
                                                        v-for="item in JSON.parse(history.is_failure)">{{item.message}}
                                                    </div>
                                                </div>
                                            </b-collapse>
                                        </div>
                                    </b-card-body>
                                </b-card>
                            </div>
                            <div v-else-if="rankingHistory.id && seoPageType==='rankings'">
                                <div>
                                    <b-card class="shadow-none">
                                        <div class="list-group list-group-flush my-n3">
                                            <div class="list-group-item py-3">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <p class="mb-0 text-muted small">URL</p>
                                                    <p class="mb-0 small">
                                                        <b-link :href="rankingHistory.url" target="_blank"> {{
                                                            rankingHistory.url }}</b-link>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="list-group-item py-3">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <p class="mb-0 text-muted small">Keyword</p>
                                                    <p class="mb-0 small">{{ rankingHistory.keywords }}</p>
                                                </div>
                                            </div>
                                            <div class="list-group-item py-3">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <p class="mb-0 text-muted small">Country</p>
                                                    <p class="mb-0 small">
                                                        <country-flag :id="`country-${rankingHistory.country}`"
                                                            :country="rankingHistory.country" size="small" /><span
                                                            :id="`country-${rankingHistory.country}`" class="ml-2">{{
                                                            regionNames.of(rankingHistory.country) }}</span>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </b-card>
                                </div>
                                <div
                                    class="list-group list-group-flush list-group-activity my-n3 crm-activity-timeline max-height-550 overflow-onhover">
                                    <div class="list-group-item" v-for="item in JSON.parse(rankingHistory.history)">
                                        <div class="row align-items-center">
                                            <div class="col-auto">
                                                <div class="avatar-sm">
                                                    <div
                                                        class="avatar-title font-size-lg bg-primary-soft rounded-circle text-primary">
                                                        <i class="fe fe-award"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col ml-n3">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <div class="d-flex">
                                                        <p class="mb-0 text-muted">Position</p>
                                                        <p class="mb-0 ml-2">
                                                            <span class="badge badge-soft-warning small">
                                                                {{item.history}}</span>
                                                        </p>
                                                        <p class="mb-0 ml-2 font-size-base">
                                                            {{moment(moment .utc(item.updated_date) .local()
                                                            .format('YYYY-MM-DD HH:mm:ss')).fromNow()}}
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div v-else-if="linkTrackingNotes.length">
                                <b-card class="shadow-none">
                                    <div class="bg-soft-light w-100 p-3 rounded mb-3"
                                        v-for="(note,index) in linkTrackingNotes" :key="index">
                                        <p v-html="note.note" class="mb-0 p-mb-0"></p>
                                    </div>
                                </b-card>
                            </div>
                            <div v-else-if="linkTrackingActivities.length">
                                <div
                                    class="list-group list-group-flush list-group-activity my-n3 crm-activity-timeline max-height-550 overflow-onhover">
                                    <div class="list-group-item" v-for="(activity, index) in linkTrackingActivities"
                                        :key="index">
                                        <div class="row align-items-center">
                                            <div class="col-auto">
                                                <div class="avatar-sm">
                                                    <div
                                                        class="avatar-title font-size-lg bg-primary-soft rounded-circle text-primary">
                                                        <i class="fe fe-award"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col ml-n3">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <div class="d-flex">
                                                        <p class="mb-0 text-body">{{activity.activity}}</p>

                                                        <p class="mb-0 ml-2 font-size-base">
                                                            {{moment(activity.created_date).fromNow()}}
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div v-else class="text-center">
                                <!-- {{seoPageType==='link_tracking'?"No Data Available":"No History"}} -->
                                <img width="250" class="pt-2"
                                    src="https://infinity.500apps.com/img/empty-states/projectsly/no-reports.svg" />
                                <h3 class="font-weight-bold pt-4 mb-2" style="font-size: 20px">No Data Available</h3>
                                <p style="font-size: 16px">Kindly change the date range and try again</p>
                            </div>
                        </b-sidebar>
                    </b-tab>
                    <!-- Outreachly Tab -->
                    <b-tab title="Outreachly" class="w-100" @click="resetDates('outreachly')">
                        <!-- Outreachly Header -->
                        <div class="row mx-0">
                            <div
                                class="bg-light col-12 d-md-block d-lg-flex d-block justify-content-between px-3 padding-20 align-items-center">
                                <h2 class="font-weight-bold mb-0 text-nowrap">Outreachly Reports</h2>
                                <div class="d-lg-flex d-md-flex d-block py-2">
                                    <div class="my-1 width_330 text-lg-right">
                                        <b-form-group label-cols-lg="2" content-cols-lg="10" content-cols="12"
                                            label-class="text-lg-right text-left" content-class="px-0"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-1" label="From"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-5-analytic" class="border" v-model="fromDate"
                                                locale="en" @input="dateSelected()" type="date" required
                                                placeholder="From date"></b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                    <div class="ml-lg-n4 ml-md-n2 my-1 pl-md-1 width_330">
                                        <b-form-group label-class="text-lg-right text-left" content-class="px-0"
                                            label-cols-lg="2" content-cols="12" content-cols-lg="10"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-2" label="To"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-end-date-analytic" class="border"
                                                v-model="toDate" :min="fromDate" locale="en"
                                                @input="showOutreachlyReports()" type="date" :max="maxDate" required
                                                placeholder="To date" :disabled="!fromDate">
                                            </b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Outreachly Graphs -->
                        <div>
                            <div class="row mx-0 mx-lg-3">
                                <b-col lg="6" md="12" v-for="chart in outreachlyList" :key="chart.value"
                                    class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <figure v-if="!chart.emptyState" class="highcharts-figure">
                                        <div :id="`container-pie-outreachly-${chart.value}`"></div>
                                    </figure>
                                    <div v-else class="col-12 col-md-12 col-12 pr-5 text-center min-height-60vh">
                                        <img width="320" class="pt-6"
                                            src="https://infinity.500apps.com/img/empty-states/projectsly/no-reports.svg" />
                                        <h3 class="font-weight-bold pt-4 mb-2" style="font-size: 20px">No data available
                                        </h3>
                                        <p style="font-size: 16px">Kindly change the date range and try again</p>
                                    </div>
                                </b-col>
                                </b-col>
                            </div>
                        </div>
                    </b-tab>
                    <!-- Support Tab -->
                    <b-tab title="Support" class="w-100" @click="resetDates('support')">
                        <div class="row mx-0">
                            <div
                                class="bg-light col-12 d-md-block d-lg-flex d-block justify-content-between px-3 padding-20 align-items-center">
                                <h2 class="font-weight-bold mb-0 text-nowrap">Support Reports</h2>
                                <div class="d-lg-flex d-md-flex d-block py-2">
                                    <div class="my-1 width_330 text-lg-right">
                                        <b-form-group label-cols-lg="2" content-cols-lg="10" content-cols="12"
                                            label-class="text-lg-right text-left" content-class="px-0"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-1" label="From"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-5-analytic" class="border" v-model="fromDate"
                                                locale="en" @input="dateSelected()" type="date" required
                                                placeholder="From date"></b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                    <div class="ml-lg-n4 ml-md-n2 my-1 pl-md-1 width_330">
                                        <b-form-group label-class="text-lg-right text-left" content-class="px-0"
                                            label-cols-lg="2" content-cols="12" content-cols-lg="10"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-2" label="To"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-end-date-analytic" class="border"
                                                v-model="toDate" :min="fromDate" locale="en"
                                                @input="showSupportReports()" type="date" :max="maxDate" required
                                                placeholder="To date" :disabled="!fromDate">
                                            </b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- NinjaChat Graphs -->
                        <div>
                            <div class="row mx-0 mx-lg-3">
                                <b-col v-if="emptyState"
                                    class="col-12 col-md-12 col-12 pr-5 text-center min-height-60vh">
                                    <img width="320" class="pt-6"
                                        src="https://infinity.500apps.com/img/empty-states/projectsly/no-reports.svg" />
                                    <h3 class="font-weight-bold pt-4 mb-2" style="font-size: 20px">No data available
                                    </h3>
                                    <p style="font-size: 16px">Kindly change the date range and try again</p>
                                </b-col>

                                <b-col lg="6" md="12" class="py-lg-5 py-3 px-0 min-height-60vh"
                                    v-for="token in supportTokenData" :key="token.group_id">
                                    <figure class="highcharts-figure">
                                        <div :id="`container-pie-support-${token.group_id}`"></div>
                                    </figure>
                                </b-col>
                            </div>
                        </div>
                        <!-- Support Table -->
                        <b-card v-for="(item,index) in supportTableData" :key="index">
                            <b-table striped hover :fields="supportFields" :items="item.data" class="table-sm">
                            </b-table>
                        </b-card>


                        <b-overlay :show="isBusy || loadContentData " no-wrap opacity="0.5" spinner-variant="primary">
                        </b-overlay>
                    </b-tab>
                    <b-tab title="Git" class="w-100" @click="resetDates('git')">
                        <div class="row mx-0">
                            <div
                                class="bg-light col-12 d-md-block d-lg-flex d-block justify-content-between px-3 padding-20 align-items-center">
                                <h2 class="font-weight-bold mb-0 text-nowrap">Github Report</h2>
                                <div class="d-lg-flex d-md-flex d-block py-2">
                                    <div class="my-1 width_330 text-lg-right">
                                        <b-form-group label-cols-lg="2" content-cols-lg="10" content-cols="12"
                                            label-class="text-lg-right text-left" content-class="px-0"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-1" label="From"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-5-analytic" class="border" v-model="fromDate"
                                                locale="en" @input="getgitData()" type="date" required
                                                placeholder="From date"></b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <div class="row mx-0 mx-lg-3" v-if="showGitReports">
                                <b-col class="col-6   col-6 text-center min-height-60vh">
                                    <label>500appsInfinity </label>
                                    <iframe :key="rerender"
                                        :src="`https://gitstats.500apps.com/-stats_?repo=agilecrm/500appsInfinity&since=${fromDate}`"
                                        height="800px" width="100%" title="500appsInfinity"></iframe>
                                </b-col>
                                <b-col class="col-6  col-6 text-center min-height-60vh">
                                    <label>infinity-public</label>
                                    <iframe :key="rerender"
                                        :src="`https://gitstats.500apps.com/-stats_?repo=agilecrm/infinity-public&since=${fromDate}`"
                                        height="800px" width="100%" title="infinity-public"></iframe>
                                </b-col>
                                <b-col class="col-6  col-6 text-center min-height-60vh">
                                    <label>python</label>
                                    <iframe :key="rerender"
                                        :src="`https://gitstats.500apps.com/-stats_?repo=agilecrm/python&since=${fromDate}`"
                                        height="800px" width="100%" title="python"></iframe>
                                </b-col>
                                <b-col class="col-6   col-6 text-center min-height-60vh">
                                    <label>infinity-db</label>
                                    <iframe :key="rerender"
                                        :src="`https://gitstats.500apps.com/-stats_?repo=agilecrm/infinity-db&since=${fromDate}`"
                                        height="800px" width="100%" title="infinity-db"></iframe>
                                </b-col>
                            </div>
                        </div>

                        <b-overlay :show="isBusy || loadContentData " no-wrap opacity="0.5" spinner-variant="primary">
                        </b-overlay>
                    </b-tab>
                    <b-tab title="Sites Status" class="w-100" @click="showSitesStatus=true">
                        <div class="row mx-0 mx-lg-3" v-if="showSitesStatus">
                            <b-col class="col-12 col-12 text-center min-height-60vh">
                                <iframe src="https://sites-status.500apps.net" height="800px" width="100%"
                                    title="500appsInfinity"></iframe>
                            </b-col>
                        </div>
                    </b-tab>
                    <b-tab title="Projectsly" class="w-100" @click="resetDates('projectsly')" lazy>
                        <div>
                            <b-tabs content-class="mt-3" align="left" card @input="tab_clicked">
                                <b-tab v-for="(team, index) in teams" :key="index" :title="team.name">
                                    <div class="my-1 width_250 mb-3">
                                        <b-form-group class="mb-0" label-class="text-lg-right text-left"
                                            content-class="px-0" label-cols-lg="6" content-cols-lg="6"
                                            content-cols-md="6" content-cols="6" label="Select a Sprint: ">
                                            <b-form-select v-model="goal" :options="goals" text-field="name"
                                                value-field="name" @change="get_goals_by_tasks()"></b-form-select>
                                        </b-form-group>
                                    </div>
                                    <b-row>
                                        <b-col lg="3">
                                            <b-card body-class="p-3 m-1" class="shadow-none mb-3">
                                                <b-row class="align-items-center">
                                                    <div class="col">
                                                        <!-- Title -->
                                                        <h3 class="text-uppercase text-muted mb-2">
                                                            Total Tasks
                                                        </h3>
                                                        <!-- Heading -->
                                                        <span v-if="projectsly_incomplete_tasks[0]" class="h2 mb-0">
                                                            {{projectsly_incomplete_tasks[0].count }}
                                                        </span>
                                                    </div>
                                                </b-row>
                                                <!-- / .row -->
                                            </b-card>
                                        </b-col>
                                        <b-col lg="3">
                                            <b-card body-class="p-3 m-1" class="shadow-none mb-3">
                                                <b-row class="align-items-center">
                                                    <div class="col">
                                                        <!-- Title -->
                                                        <h3 class="text-uppercase text-muted mb-2">
                                                            Completed Tasks
                                                        </h3>
                                                        <!-- Heading -->
                                                        <span v-if="projectsly_completed_tasks[0]" class="h2 mb-0">
                                                            {{ projectsly_completed_tasks[0].complete_count}}
                                                        </span>
                                                    </div>
                                                </b-row>
                                                <!-- / .row -->
                                            </b-card>
                                        </b-col>
                                        <b-col lg="3">
                                            <b-card body-class="p-3 m-1" class="shadow-none mb-3">
                                                <b-row class="align-items-center">
                                                    <div class="col">
                                                        <!-- Title -->
                                                        <h3 class="text-uppercase text-muted mb-2">
                                                            Total hours
                                                        </h3>
                                                        <!-- Heading -->
                                                        <span v-if="projectsly_incomplete_tasks[0]" class="h2 mb-0">
                                                            {{projectsly_incomplete_tasks[0].total_est_hrs ?
                                                            projectsly_incomplete_tasks[0].total_est_hrs : 0 }}
                                                        </span>
                                                    </div>
                                                </b-row>
                                                <!-- / .row -->
                                            </b-card>
                                        </b-col>
                                        <b-col>
                                            <b-card body-class="p-3 m-1" class="shadow-none mb-3">
                                                <b-row class="align-items-center">
                                                    <div class="col">
                                                        <!-- Title -->
                                                        <h3 class="text-uppercase text-muted mb-2">
                                                            Completed Hours
                                                        </h3>
                                                        <!-- Heading -->
                                                        <span v-if="projectsly_completed_tasks[0]" class="h2 mb-0">
                                                            {{
                                                            projectsly_completed_tasks[0].total_completed_hrs?projectsly_completed_tasks[0].total_completed_hrs:0}}
                                                        </span>
                                                    </div>
                                                </b-row>
                                                <!-- / .row -->
                                            </b-card>
                                        </b-col>
                                    </b-row>
                                    <b-card no-body>
                                        <b-table class="mb-3 table-sm card-table mt-3" :current-page="currentPage"
                                            :per-page="results_per_page" stacked="md" responsive :striped="true"
                                            caption-top hover :fields="projectsly_table_fields"
                                            :items="assignee_incomplete_tasks">
                                            <template #cell(total_est_hrs)="data">
                                                {{ data.item.total_est_hrs ? data.item.total_est_hrs :0 }}
                                            </template>
                                            <template #cell(assignee_id)="data">
                                                {{ data.item.assignee_id?get_user_name(data.item.assignee_id):'No
                                                assignee' }}
                                            </template>
                                            <template #cell(completed_hrs)="data">
                                                {{ data.item.completed_hrs ? data.item.completed_hrs : 0 }}
                                            </template>
                                            <template #cell(completed_count)="data">
                                                {{ data.item.completed_count ? data.item.completed_count : 0 }}
                                            </template>
                                        </b-table>
                                        <div class="overflow-auto" v-if="total_user_tasks > results_per_page">
                                            <b-pagination v-model="currentPage" :total-rows="total_user_tasks" pills
                                                :per-page="results_per_page" size="md" class="my-0" align="center"
                                                next-class="ml-auto next " prev-class="mr-auto prev "
                                                hide-goto-end-buttons>
                                                <template #prev-text>
                                                    <b-link class="page-link pl-0 pr-4 border-right mr-auto" href="#">
                                                        Prev </b-link>
                                                </template>
                                                <template #next-text>
                                                    <b-link class="page-link pl-4 pr-0 border-left ml-auto" href="#">
                                                        Next
                                                    </b-link>
                                                </template>
                                            </b-pagination>
                                        </div>
                                    </b-card>
                                </b-tab>
                            </b-tabs>
                        </div>
                    </b-tab>
                    <!-- NinjaChat Tab -->
                    <b-tab title="NinjaChat" class="w-100" @click="resetDates('ninjachat')">
                        <!-- NinjaChat Header -->
                        <div class="row mx-0">
                            <div
                                class="bg-light col-12 d-md-block d-lg-flex d-block justify-content-between px-3 padding-20 align-items-center">
                                <h2 class="font-weight-bold mb-0 text-nowrap">NinjaChat Reports</h2>
                                <div class="d-lg-flex d-md-flex d-block py-2">
                                    <div class="my-1 width_330 text-lg-right">
                                        <b-form-group label-cols-lg="2" content-cols-lg="10" content-cols="12"
                                            label-class="text-lg-right text-left" content-class="px-0"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-1" label="From"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-5-analytic" class="border" v-model="fromDate"
                                                locale="en" @input="dateSelected()" type="date" required
                                                placeholder="From date"></b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                    <div class="ml-lg-n4 ml-md-n2 my-1 pl-md-1 width_330">
                                        <b-form-group label-class="text-lg-right text-left" content-class="px-0"
                                            label-cols-lg="2" content-cols="12" content-cols-lg="10"
                                            content-cols-md="12" class="px-md-1 mb-0" id="input-group-2" label="To"
                                            label-for="input-5" class="mb-0">
                                            <b-form-datepicker id="input-end-date-analytic" class="border"
                                                v-model="toDate" :min="fromDate" locale="en"
                                                @input="showNinjachatReports()" type="date" :max="maxDate" required
                                                placeholder="To date" :disabled="!fromDate">
                                            </b-form-datepicker>
                                        </b-form-group>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- NinjaChat Graphs -->
                        <div>
                            <div class="row mx-0 mx-lg-3">
                                <b-col v-if="emptyState"
                                    class="col-12 col-md-12 col-12 pr-5 text-center min-height-60vh">
                                    <img width="320" class="pt-6"
                                        src="https://infinity.500apps.com/img/empty-states/projectsly/no-reports.svg" />
                                    <h3 class="font-weight-bold pt-4 mb-2" style="font-size: 20px">No data available
                                    </h3>
                                    <p style="font-size: 16px">Kindly change the date range and try again</p>
                                </b-col>

                                <b-col lg="6" md="12" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <figure v-if="!hideDepartments" class="highcharts-figure">
                                        <div id="container-pie-ninjachat-departments"></div>
                                    </figure>
                                </b-col>
                                <b-col lg="6" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <figure v-if="!hideAgents" class="highcharts-figure">
                                        <div id="container-pie-ninjachat-agents"></div>
                                    </figure>
                                </b-col>
                                <b-col lg="6" class="py-lg-5 py-3 px-0 min-height-60vh">
                                    <figure v-if="!hideMissedChats" class="highcharts-figure">
                                        <div id="container-pie-ninjachat-missedChats"></div>
                                    </figure>
                                </b-col>
                            </div>
                        </div>
                        <!-- NinjaChat Table -->
                        <div>
                            <b-tabs>
                                <b-tab :title="app.text" v-for="app in ninjaChatList">
                                    <div v-if="ninjachatTableData[app.value] && ninjachatTableData[app.value].length"
                                        class="d-flex justify-content-end my-3">
                                        <b-button :variant="!accordionVisible[app.value]?'primary':'secondary'"
                                            @click="accordionVisible[app.value]=!accordionVisible[app.value]">
                                            Toggle accrodions
                                        </b-button>
                                    </div>
                                    <div v-for="item in ninjachatTableData[app.value]">
                                        <b-card-header header-tag="header" class="p-0 height-50" role="tab">
                                            <b-button v-b-toggle="`collapse-${item[0].id}`" variant="white"
                                                class="text-left">
                                                {{item.show_name}}</b-button>
                                        </b-card-header>
                                        <div>
                                            <b-collapse :id="`collapse-${item[0].id}`"
                                                :visible="accordionVisible[app.value]">
                                                <b-table striped hover :fields="getTableFields(app.value)" :items="item"
                                                    class="table-sm">
                                                    <template #cell(name)="data">
                                                        {{ data.value ? data.value : "N/A"}}
                                                    </template>
                                                    <template #cell(city)="data">
                                                        <span class="ml-2 pl-1 text-capitalize">{{ data.value}}</span>
                                                    </template>
                                                    <template #cell(os)="data">
                                                        <b-img :src="getOSType(data.value)" class="img-fluid" alt="..."
                                                            width="20" height="20">
                                                        </b-img>
                                                    </template>
                                                    <template #cell(browser_version)="data">
                                                        <b-img :src="getBrowserType(data.value)" class="img-fluid"
                                                            alt="..." width="20" height="20">
                                                        </b-img>
                                                    </template>
                                                    <template #cell(device_type)="data">
                                                        <span :title="getDeviceType(data.value)"
                                                            :class=`icons-small-${getDeviceType(data.value)}`></span>
                                                        <!-- <b-img :src="getDeviceType(data.value)" class="img-fluid" alt="..." width="20" height="20"></b-img> -->
                                                    </template>
                                                    <template #cell(from_url)="data">
                                                        <b-link href="data.value">
                                                            {{data.value}}
                                                        </b-link>
                                                    </template>
                                                    <template #cell(reference_url)="data">
                                                        <b-link v-if="data.value" :href="data.value" target="_blank"
                                                            v-b-tooltip:hover :title="data.value">{{ data.value }}
                                                        </b-link>
                                                        <span v-else>N/A</span>
                                                    </template>
                                                    <template #cell(is_block_ip_address)="data">
                                                        {{ data.value ? "Blocked" : ""}}
                                                    </template>
                                                    <template #cell(client_name)="data">
                                                        {{ data.value ? data.value :"N/A" }}
                                                    </template>
                                                    <template #cell(show_message)="data">
                                                        <div v-if="data">
                                                            {{
                                                            JSON.parse(data.item.chat_history)[0].to.message.replace(regex,"")
                                                            }}
                                                        </div>
                                        </div>
                                        </template>
                                        <template #cell(lines)="data">
                                            {{ JSON.parse(data.item.chat_history).length }}
                                        </template>
                                        <template #cell(duration)="data">
                                            {{ getMessageDuration(data.item.chat_history)}}
                                        </template>
                                        <template #cell(closed_by)="data">
                                            {{ data.value }}
                                        </template>

                                        <template #cell(chat_history)="data">
                                            <div class="d-flex cursor-pointer mt-n1 mt-lg-0" v-b-tooltip.hover
                                                title="Full Chat Transcript" @click="chatTranscript(data.item)">
                                                <b-img src="https://infinity.500apps.com/img/forms/list.png"
                                                    class="img-fluid" alt="..." width="20" height="20"></b-img>
                                            </div>
                                        </template>

                                        <template #cell(response)="data">
                                            <div class="d-flex cursor-pointer option-icons mt-n1 mt-lg-0"
                                                v-b-tooltip.hover title="Feedback" v-if="data.item.response"
                                                @click="showFeedback(data.item)">
                                                <b-img src="https://infinity.500apps.com/img/forms/list.png"
                                                    class="img-fluid" alt="..." width="20" height="20"></b-img>
                                            </div>
                                            <div v-else>--</div>
                                        </template>
                                        <template #cell(tag_name)="data">
                                            <div v-if="data.value">{{ data.value }}</div>
                                            <div v-else>--</div>
                                        </template>
                                        <template #cell(created_date)="data">
                                            {{moment(data.value).fromNow()}}
                                        </template>
                                        </b-table>
                                        </b-collapse>
                                    </div>
                                </b-tab>
                            </b-tabs>
                        </div>
                        <b-overlay :show="isBusy || loadContentData " no-wrap opacity="0.5" spinner-variant="primary">
                        </b-overlay>
                        <b-sidebar :id="`transcript_slideout-${chatInfo.contact_id}`"
                            body-class="overflow-x-hidden p-0 script-p-0"
                            sidebar-class="border-left multi-sidebar slideout-body" right no-header shadow
                            bg-variant="white" width="80%" ref="slideout_ref">
                            <template #default="{ hide }">
                                <div
                                    class="d-flex justify-content-between align-items-center flex-row-reverse bg-white border-bottom rounded-0 close-btn-right p-3">
                                    <div class="align-items-center d-flex">
                                        <b-button-group>
                                            <b-button variant="white px-3 border-right-0 rounded-right-0" size="sm"
                                                :disabled="disabledPrev"
                                                @click="changeChatTranscripts(chatInfo, 'prev',ninjachatTableData['departments'])">
                                                <span class="text-muted mr-2">&#60;</span><span
                                                    class="d-none d-md-inline-block">prev</span>
                                            </b-button>
                                            <b-button variant="white px-3 rounded-left-0 cursor-pointer" size="sm"
                                                :disabled="disabledNext"
                                                @click="changeChatTranscripts(chatInfo, 'next',ninjachatTableData['departments'])">
                                                <span class="d-none d-md-inline-block cursor-pointer">next <span
                                                        class="text-muted ml-2">&#62;</span></span>
                                            </b-button>
                                        </b-button-group>
                                        <div class="font-size-lg mr-4 ml-4 text-muted">
                                            <span class="cursor-pointer" @click="hide">x</span>
                                        </div>
                                    </div>
                                    <h3 class="mb-0">Chat Transcript</h3>
                                </div>
                                <div>
                                    <b-row class="mx-0 chat-transcript-sidelout">
                                        <b-col lg="4" md="12"
                                            class="p-17px border-right order-2 order-lg-1 bg-soft-light p-4  vh-100">
                                            <b-card class="shadow-none mb-3" body-class="p-0">
                                                <div class="height-50 p-3 border-bottom d-flex align-items-center">
                                                    <h4 class="mb-0 mt-1">Details</h4>
                                                </div>
                                                <div class="text-left p-4">
                                                    <div
                                                        class="ninjachat-small-2 d-flex justify-content-between align-items-center mb-0">
                                                        <div>
                                                            <h5 class="mb-0">Visitor</h5>
                                                        </div>
                                                        <div class="d-flex align-items-center">
                                                            <b-img :src="getBrowserType(chatInfo.browser_version)"
                                                                class="mr-2" alt="..." width="15" height="15"></b-img>
                                                            <b-img :src="getOSType(chatInfo.os)" class="mr-2" alt="..."
                                                                width="15" height="15">
                                                            </b-img>
                                                            <span :title="getDeviceType(chatInfo.device_type)"
                                                                :class=`icons-small-${getDeviceType(chatInfo.device_type)}`
                                                                class="mr-2"></span>
                                                            <!-- <b-img :src="getCountry(chatInfo.country)" class="img-fluid" alt="..." width="20" height="20"></b-img> -->
                                                            <span title="India"
                                                                :class="getCountry(chatInfo.country)"></span>
                                                            <span class="ml-2 pl-1 text-capitalize">{{
                                                                chatInfo.country}}</span>
                                                        </div>
                                                    </div>
                                                    <hr class="my-3" />
                                                    <div class="list-group list-group-flush my-n3">
                                                        <div class="list-group-item">
                                                            <div class="row align-items-center">
                                                                <div class="col">
                                                                    <h5 class="mb-0">
                                                                        Name
                                                                    </h5>
                                                                </div>
                                                                <div class="col-auto">
                                                                    <small class="text-muted">{{ chatInfo.name ?
                                                                        chatInfo.name :
                                                                        "N/A"}}</small>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-group-item">
                                                            <div class="row align-items-center">
                                                                <div class="col">
                                                                    <h5 class="mb-0">
                                                                        Email
                                                                    </h5>
                                                                </div>
                                                                <div class="col-auto">
                                                                    <small class="text-muted">
                                                                        {{ chatInfo.email ? chatInfo.email : "N/A" }}
                                                                    </small>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-group-item">
                                                            <div class="row align-items-center">
                                                                <div class="col">
                                                                    <h5 class="mb-0">
                                                                        From URL
                                                                    </h5>
                                                                </div>
                                                                <div class="col-auto">
                                                                    <small class="text-muted">
                                                                        <b-link :href="chatInfo.from_url"
                                                                            target="_blank">{{
                                                                            chatInfo.from_url }}</b-link>
                                                                    </small>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-group-item">
                                                            <div class="row align-items-center">
                                                                <div class="col">
                                                                    <h5 class="mb-0">
                                                                        Refferer URL
                                                                    </h5>
                                                                </div>
                                                                <div class="col-auto">
                                                                    <small class="text-muted">
                                                                        <div class="text-truncate-20ch">
                                                                            <b-link v-if="chatInfo.reference_url"
                                                                                :href="chatInfo.reference_url"
                                                                                target="_blank" v-b-tooltip:hover
                                                                                :title="chatInfo.reference_url">{{
                                                                                chatInfo.reference_url }}</b-link>
                                                                            <span v-else>N/A</span>
                                                                        </div>
                                                                    </small>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-group-item">
                                                            <div class="row align-items-center">
                                                                <div class="col">
                                                                    <h5 class="mb-0">
                                                                        iP Address
                                                                    </h5>
                                                                </div>
                                                                <div class="col-auto">
                                                                    <small class="small text-muted">
                                                                        {{ chatInfo.ip_address }}
                                                                    </small>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-group-item">
                                                            <div class="row align-items-center">
                                                                <div class="col">
                                                                    <h5 class="mb-0">
                                                                        Location
                                                                    </h5>
                                                                </div>
                                                                <div class="col-auto">
                                                                    <small class="small text-muted"> {{ chatInfo.city
                                                                        }},{{ chatInfo.country
                                                                        }} </small>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-group-item">
                                                            <div class="row align-items-center">
                                                                <div class="col">
                                                                    <h5 class="mb-0">
                                                                        No.of.lines
                                                                    </h5>
                                                                </div>
                                                                <div class="col-auto">
                                                                    <small class="small text-muted"> {{
                                                                        formatData().length }} </small>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="list-group-item">
                                                            <div class="row align-items-center">
                                                                <div class="col">
                                                                    <h5 class="mb-0">
                                                                        Duration
                                                                    </h5>
                                                                </div>
                                                                <div class="col-auto">
                                                                    <small class="small text-muted"> {{
                                                                        getMessageDuration(chatInfo.chat_history) }}
                                                                    </small>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="list-group-item">
                                                            <div class="row align-items-center">
                                                                <div class="col">
                                                                    <h5 class="mb-0">
                                                                        Created Date
                                                                    </h5>
                                                                </div>
                                                                <div class="col-auto">
                                                                    {{moment(chatInfo.created_date).fromNow()}}
                                                                </div>
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>
                                            </b-card>
                                        </b-col>
                                        <b-col lg="8" md="12" class="px-0 border-lg-right order-2 order-lg-1">
                                            <b-card class="shadow-none mb-3 chat-transcript border-0" body-class="p-0">
                                                <div
                                                    class="d-flex align-items-center p-3 border-bottom justify-content-between">
                                                    <h4 class="mb-0">History</h4>
                                                </div>
                                                <div>
                                                    <b-col lg="12" md="12"
                                                        class="px-0 border-lg-right order-2 order-lg-1">
                                                        <div class="p-4 ninja-chat-scroll">
                                                            <div v-for="(list, index) in formatData()" :key="index"
                                                                class="comment mb-2">
                                                                <div class="comment-body w-100" v-if="list.to">
                                                                    <div
                                                                        class="d-flex justify-content-between align-items-center">
                                                                        <h5 class="comment-title">
                                                                            Visitor
                                                                        </h5>
                                                                        <p class="comment-time">{{ list.to.time }}</p>
                                                                    </div>
                                                                    <p class="comment-text">
                                                                        {{ list.to.message }}
                                                                    </p>
                                                                </div>
                                                                <div v-else class="comment-body w-100">
                                                                    <div
                                                                        class="d-flex justify-content-between align-items-center">
                                                                        <h5 class="comment-title">
                                                                            Agents
                                                                        </h5>
                                                                        <p class="comment-time">{{ list.from.time }}</p>
                                                                    </div>
                                                                    <p v-html="list.from.message"
                                                                        class="comment-text mb-0 img-comment">
                                                                        {{ list.from.message }}
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </b-col>
                                                </div>
                                            </b-card>
                                        </b-col>
                                    </b-row>
                                </div>
                            </template>
                        </b-sidebar>


                        <!-- Chat feedback starts here -->
                        <b-sidebar :id="`feedback_slideout-${chatInfo.contact_id}`"
                            body-class="overflow-x-hidden p-0 bg-soft-light"
                            sidebar-class="border-left multi-sidebar slideout-body" right no-header shadow backdrop
                            bg-variant="white" width="550px" ref="slideout_ref">
                            <template #default="{ hide }">
                                <div
                                    class="d-flex justify-content-between align-items-center flex-row-reverse bg-white border-bottom rounded-0 close-btn-right py-3 px-4 sticky-top">
                                    <div class="align-items-center d-flex my-1">
                                        <!-- <div class="align-items-center">
              <NameInfo v-if="chatInfo.name" :name="chatInfo.name" :email="chatInfo.email" />
              <div class="mt-2">{{ $t("ninjachat.accept_helptext") }} {{ name }} <CreatedModifiedBy :row="chatInfo" :show_created_on="true" :is_500apps_user="false" /></div>
            </div> -->
                                        <b-button variant="white px-3 border-right-0 rounded-right-0 cursor-pointer"
                                            size="sm" :disabled="disabledPrev"
                                            @click="changeChatTranscripts(chatInfo, 'prev',ninjachatTableData['departments'])">
                                            <span class="d-none d-md-inline-block">prev</span>
                                        </b-button>
                                        <b-button variant="white px-3 rounded-left-0 cursor-pointer" size="sm"
                                            :disabled="disabledNext"
                                            @click="changeChatTranscripts(chatInfo, 'next',ninjachatTableData['departments'])">
                                            <span class="d-none d-md-inline-block">next</span><i
                                                class="ml-2 align-middle fe fe-arrow-right" />
                                        </b-button>
                                        <div class="font-size-lg mr-3 ml-3 text-muted">
                                            <span class="cursor-pointer" @click="hide">x</span>
                                        </div>
                                    </div>
                                    <h3 class="mb-0">Feedback</h3>
                                </div>
                                <b-card class="shadow-none card-body pt-0 m-3" v-if="chatInfo.response">

                                    <div class="last-child-border-bottom">
                                        <div v-for="input in Object.keys(feedbackResponse.inputFieldResponse)"
                                            :key="input" class="line-height-1-6 border-bottom-1px pb-3 mb-3">
                                            <h4 class="mb-1 ">{{ input }}</h4>
                                            <p class="mb-0 line-height-1-6">{{
                                                feedbackResponse.inputFieldResponse[input] }}</p>
                                        </div>
                                        <div v-for="text in Object.keys(feedbackResponse.textFieldResponse)" :key="text"
                                            class="line-height-1-6 border-bottom-1px pb-3 mb-3">
                                            <h4 class="mb-1 ">{{ text }}</h4>
                                            <p class="mb-0 line-height-1-6">{{ feedbackResponse.textFieldResponse[text]
                                                }}</p>
                                        </div>
                                        <div v-for="checkbox in Object.keys(feedbackResponse.checkBoxFieldResponse)"
                                            :key="checkbox" class="line-height-1-6 border-bottom-1px pb-3 mb-3">
                                            <h4 class="mb-1 ">{{ checkbox }}</h4>
                                            <p class="mb-0 line-height-1-6">{{
                                                feedbackResponse.checkBoxFieldResponse[checkbox] }}</p>
                                        </div>
                                        <div v-for="radio in Object.keys(feedbackResponse.radioFieldResponse)"
                                            :key="radio" class="line-height-1-6 border-bottom-1px pb-3 mb-3">
                                            <h4 class="mb-1 ">{{ radio }}</h4>
                                            <p class="mb-0 line-height-1-6">{{
                                                feedbackResponse.radioFieldResponse[radio] }}</p>
                                        </div>
                                    </div>
                                </b-card>
                                <div v-else class="align-items-center d-flex m-3">
                                    <b-card class="shadow-none" no-body>
                                        <b-card-body class="text-center p-5">
                                            <b-row class="justify-content-center">
                                                <div class="col-12 col-md-7 col-xl-7 px-0">
                                                    <!-- Image -->
                                                    <img src="https://infinity.500apps.com/img/empty-states/botup/no-bots-flows-found.svg"
                                                        alt="..." class="img-fluid mb-4 pb-2" />
                                                    <!-- Content -->
                                                    <p class="text-muted mb-0">
                                                        There is no feedback form to display.To add a feedback form
                                                        enable Post Chat Survey.
                                                    </p>
                                                </div>
                                            </b-row>
                                            <!-- / .row -->
                                        </b-card-body>
                                    </b-card>
                                </div>
                            </template>
                        </b-sidebar>
                        <!-- Chat feedback ends here -->
                    </b-tab>

                </b-tabs>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
    <script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.25.1/moment.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/data.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script src="https://blacklabel.github.io/multicolor_series/js/multicolor_series.js"></script>

    <script type="text/javascript">
        var vm = new Vue({
            el: "#signup",
            data: {
                rerender: 0,
                showGitReports: false,
                isBusy: false,
                showSitesStatus: false,
                regions: [{
                    value: "",
                    text: "All"
                },
                {
                    value: "us1",
                    text: "US (East)"
                },
                {
                    value: "us2",
                    text: "US (West)"
                },
                {
                    value: "eu1",
                    text: "Europe"
                },
                {
                    value: "ap1",
                    text: "Asia"
                },
                {
                    value: "ap2",
                    text: "Australia"
                },
                {
                    value: "sa1",
                    text: "South America"
                },
                ],
                region: "",
                fromDate: moment().format(),
                toDate: moment().format(),
                disabled: true,
                emptyState: false,
                maxDate: moment().format(),
                dataentry: null,
                datalabel: null,
                dataSet: [],
                totalSignupCount: 0,
                totalRegionsCount: 0,
                deviceReort: {},
                appsReport: {},
                browserReport: {},
                countryReport: {},
                authReport: {},
                hideBrowserReport: false,
                hideDeviceReport: false,
                hideAppsReport: false,
                hideCountryReport: false,
                hideAuthReport: false,
                hideAllTypeLineReport: false,
                hideAp1TypeLineReport: false,
                hideAp2TypeLineReport: false,
                hideUs1TypeLineReport: false,
                hideUs2TypeLineReport: false,
                hideSa1TypeLineReport: false,
                hideEu1TypeLineReport: false,
                isComparisionLoading: false,
                hideAnalyticsReport: false,
                tabType: "signups",
                analyticsList: [{
                    value: "app",
                    text: "App"
                },
                {
                    value: "country",
                    text: "Country"
                },
                {
                    value: "sessionMedium",
                    text: "Session Medium"
                },
                ],
                ninjaContentList: [{
                    value: "live_contents",
                    text: "Live Contents"
                },
                {
                    value: "distribution_stats",
                    text: "Distribution Stats"
                },
                ],
                outreachlyList: [{
                    value: "total_prospects_projectwise",
                    text: "Total Prospects ProjectWise",
                    emptyState: false
                },
                {
                    value: "total_prospects_memberwise",
                    text: "Total Prospects MemberWise",
                    emptyState: false
                },
                {
                    value: "total_calls_projectwise",
                    text: "Total Calls ProjectWise",
                    emptyState: false
                },
                {
                    value: "total_calls_memberwise",
                    text: "Total Calls MemberWise",
                    emptyState: false
                },
                {
                    value: "total_emails_projectwise",
                    text: "Total Emails ProjectWise",
                    emptyState: false
                },
                {
                    value: "total_emails_memberwise",
                    text: "Total Emails MemberWise",
                    emptyState: false
                },
                {
                    value: "total_tasks_projectwise",
                    text: "Total Tasks ProjectWise",
                    emptyState: false
                },
                {
                    value: "total_tasks_memberwise",
                    text: "Total Tasks MemberWise",
                    emptyState: false
                },
                {
                    value: "total_tasks_open_projectwise",
                    text: "Total Open Tasks ProjectWise",
                    emptyState: false
                },
                {
                    value: "total_tasks_open_memberwise",
                    text: "Total Open Tasks MemberWise",
                    emptyState: false
                },
                {
                    value: "total_tasks_outstanding_projectwise",
                    text: "Total Outstanding Tasks ProjectWise",
                    emptyState: false
                },
                {
                    value: "total_tasks_outstanding_memberwise",
                    text: "Total Outstanding Tasks MemberWise",
                    emptyState: false
                },
                {
                    value: "total_tasks_closed_projectwise",
                    text: "Total Closed Tasks ProjectWise",
                    emptyState: false
                },
                {
                    value: "total_tasks_closed_memberwise",
                    text: "Total Closed Tasks MemberWise",
                    emptyState: false
                },
                ],
                ninjaSEOList: [{
                    value: "page_grader",
                    text: "Page Grader"
                },
                {
                    value: "rankings",
                    text: "Rankings"
                },
                {
                    value: "link_tracking",
                    text: "Link Tracking"
                },
                ],
                ninjaChatList: [{
                    value: "departments",
                    text: "Departments"
                },
                {
                    value: "missedChats",
                    text: "Missed Chats"
                },
                {
                    value: "agents",
                    text: "Agents"
                },
                ],
                continentList: [{
                    value: "all",
                    text: "All"
                },
                {
                    value: "AS",
                    text: "Asia"
                },
                {
                    value: "AF",
                    text: "Africa"
                },
                {
                    value: "EU",
                    text: "Europe"
                },
                {
                    value: "NA",
                    text: "North America"
                },
                {
                    value: "OC",
                    text: "Australia/Oceania"
                },
                {
                    value: "AN",
                    text: "Antarctica"
                },
                {
                    value: "SA",
                    text: "South America"
                },
                ],
                pageGraderFields: [{
                    key: "domain_url",
                    label: "Domain URL"
                },
                {
                    key: "keyword",
                    label: "Keyword",
                    sortable: true
                },
                {
                    key: "score",
                    label: "Score",
                    sortable: true
                },
                {
                    key: "is_success",
                    label: "Success"
                },
                {
                    key: "created_date",
                    label: "Created On",
                    data_type: "date",
                    sortable: true
                },
                {
                    key: "history",
                    label: ""
                },
                ],
                rankingsFields: [{
                    key: "keywords",
                    label: "Keyword"
                },
                {
                    key: "country",
                    label: "Country"
                },
                {
                    key: "created_date",
                    label: "Created Date",
                    data_type: "date"
                },
                {
                    key: "position_url",
                    label: "Position URL"
                },
                {
                    key: "keyword_position",
                    label: "Rank",
                    sortable: true
                },
                {
                    key: "updated_date",
                    label: "Updated On",
                    data_type: "date",
                    sortable: true
                },
                {
                    key: "history",
                    label: "History"
                },
                ],
                linkTrackingFields: [{
                    key: "keyword",
                    label: "Keyword"
                },
                {
                    key: "da_url",
                    label: "Backlink URL"
                },
                {
                    key: "link_status",
                    label: "Live"
                },
                {
                    key: "notes",
                    label: "Notes"
                },
                {
                    key: "link_rel",
                    label: "Track"
                },
                {
                    key: "payment_amount",
                    label: "Price"
                },
                {
                    key: "domain_authority",
                    label: "Domain Authority",
                    sortable: true
                },
                {
                    key: "activity",
                    label: ""
                },
                ],
                chatFields: [{
                    key: "client_name",
                    label: "Name"
                },
                {
                    key: "show_message",
                    label: "Message"
                },
                {
                    key: "lines",
                    label: "No.of lines"
                },
                {
                    key: "duration",
                    label: "Duration"
                },
                {
                    key: "closed_by",
                    label: "Closed By"
                },
                {
                    key: "chat_history",
                    label: "Chat History"
                },
                {
                    key: "response",
                    label: "Feedback"
                },
                {
                    key: "tag_name",
                    label: "tags"
                },
                {
                    key: "created_date",
                    label: "Created Date",
                    data_type: "date"
                },
                ],
                contactFields: [{
                    key: "name",
                    label: "Name"
                },
                {
                    key: "from_url",
                    label: "From URL"
                },
                {
                    key: "reference_url",
                    label: "Referrer URL"
                },
                {
                    key: "ip_address",
                    label: "Ip Address"
                },
                {
                    key: "city",
                    label: "City"
                },
                {
                    key: "resolution",
                    label: "Resolution"
                },
                {
                    key: "device_type",
                    label: "Device Type",
                    thClass: "text-center",
                    tdClass: "text-center"
                },
                {
                    key: "os",
                    label: "OS",
                    thClass: "text-center",
                    tdClass: "text-center"
                },
                {
                    key: "browser_version",
                    label: "Browser Version",
                    thClass: "text-center",
                    tdClass: "text-center"
                },
                {
                    key: "is_block_ip_address",
                    label: "",
                    thClass: "text-center",
                    tdClass: "text-center"
                },
                {
                    key: "created_date",
                    label: "Created Date",
                    data_type: "date"
                },
                ],
                supportFields: [{
                    key: "id",
                    label: "Ticket ID"
                },
                {
                    key: "first_name",
                    label: "Requester Name"
                },
                {
                    key: "email",
                    label: "Email"
                },
                {
                    key: "subject",
                    label: "Subject"
                },
                {
                    key: "ticket_status",
                    label: "Status"
                },
                {
                    key: "priority",
                    label: "Priority"
                },
                {
                    key: "created_date",
                    label: "Created On"
                },
                ],
                host: "https://api.500apps.com",
                appsList: [],
                showAllAppsOnce: false,
                hideLiveConent: false,
                hideDistributionStats: false,
                contentUrls: [],
                hideContentURlsList: false,
                outreachlyMembers: [],
                email_member: "",
                call_member: "",
                loadContentData: false,
                hidePageGrader: false,
                hideRankings: false,
                hideLinkTracking: false,
                seoPageType: "",
                pageGraderHistory: [],
                rankingHistory: {},
                linkTrackingNotes: [],
                linkTrackingActivities: [],
                regionNames: new Intl.DisplayNames(["en"], {
                    type: "region"
                }),
                userNamesData: {},
                seoStatistics: {
                    below_100: [],
                    below_50: [],
                    below_25: [],
                    below_10: [],
                    below_5: [],
                },
                RankingsKeywordCount: "",
                RankingsDomainCount: "",
                seoTableData: {
                    page_grader: [],
                    rankings: [],
                    link_tracking: [],
                },
                accordionVisible: {
                    page_grader: true,
                    rankings: true,
                    link_tracking: true,
                },
                scrollCount: 10,
                seoURLsData: {},
                currentSeoTabIndex: 0,
                ninjachatTableData: {
                    departments: [],
                    agents: [],
                    missedChats: [],
                },
                accordionVisible: {
                    page_grader: true,
                    rankings: true,
                    link_tracking: true,
                    departments: true,
                    missedChats: true,
                },
                chatInfo: {},
                regex: /<[^>]*(>|$)|&nbsp;|&gt;/g,
                disabledPrev: false,
                disabledNext: false,
                feedbackResponse: {},
                hideDepartments: false,
                hideAgents: false,
                hideMissedChats: false,
                supportTokenData: [],
                supportTableData: [],
                // Team wise project id's(Auto Generated id)
                teams: [{
                    name: "Team1",
                    project_id: ["3766", "3756", "3755", "3754", "3752", "3726", "3721", "3719", "3712",
                        "3691", "3690", "4225"
                    ]
                },
                {
                    name: "Team2",
                    project_id: ["3947", "3934", "3879", "3582", "3580", "3579", "3574"]
                },
                {
                    name: "Team3",
                    project_id: ["3948", "3864", "3759", "3713", "3583", "3581", "3572", "3569", "3562",
                        "3561", "4046"
                    ]
                },
                {
                    name: "Team4",
                    project_id: ["4001", "3720", "3577", "3571", "3570", "3568", "3564", "3560", "3558",
                        "3557"
                    ]
                },
                ],
                projectsly_incomplete_tasks: [],
                projectsly_completed_tasks: [],
                assignee_incomplete_tasks: [],
                assignee_completed_tasks: [],
                projectsly_table_fields: [{
                    key: "assignee_id",
                    label: "Assignee",
                    sortable: true,
                },
                {
                    key: "total_est_hrs",
                    label: "Estimatd Hours",
                    sortable: false,
                },
                {
                    key: "completed_hrs",
                    label: "Completed Hours",
                    sortable: false,
                },
                {
                    key: "count",
                    label: "Total Tasks",
                    sortable: false,
                },
                {
                    key: "completed_count",
                    label: "Completed Tasks",
                    sortable: false,
                },
                ],
                currentPage: 1,
                goals: [],
                goal: "All",
                goals_array: [],
                total_user_tasks: 0,
                results_per_page: 10,
                projectsly_table_items: [],
                loading: false,
            },
            async mounted() {
                let minDate = new Date(this.toDate);
                this.fromDate = moment(new Date(minDate.setDate(minDate.getDate() - 7))).format(
                    "YYYY-MM-DD");
                this.generateReport();
                this.pieChartData();
                this.reportsByCategory();
                if (window.location.href.includes("env=dev")) this.host = "https://api.dev.500apps.com";
                else this.host = "https://api.500apps.com";
                this.getUserData()
            },

            computed: {
                getUserName() {
                    return this.userNamesData;
                },
            },

            methods: {
                getgitData() {
                    this.showGitReports = false;
                    this.rerender += 1;
                    this.showGitReports = true;
                },
                resetDates(type) {
                    self.emptyState = false;
                    this.toDate = new Date();
                    let minDate = new Date(this.toDate);
                    this.fromDate = moment(new Date(minDate.setDate(minDate.getDate() - 7))).format(
                        "YYYY-MM-DD");
                    if (type == "git") this.showGitReports = true;
                    else this.showGitReports = false;
                    if (type == "analytics") {
                        this.generateBarAnalytics();
                        this.tabType = "analytics";
                    } else if (type == "ninjacontent") {
                        this.showContentReports();
                        this.tabType = "ninjacontent";
                    } else if (type == "ninjaseo") {
                        this.showSEOReports();
                        this.tabType = "ninjaseo";
                    } else if (type == "outreachly") {
                        this.showOutreachlyReports();
                        this.tabType = "outreachly";
                    } else if (type == "ninjachat") {
                        this.showNinjachatReports();
                        this.tabType = "ninjachat";
                    } else if (type === "support") {
                        this.showSupportReports();
                        this.tabType = "support";
                    } else if (type == "projectsly") {
                        this.show_projectsly_reports();
                        this.tabType = "projectsly";
                    } else {
                        this.tabType = "signups";
                        this.generateReport();
                        this.pieChartData();
                        this.reportsByCategory();
                    }
                },
                async dateSelected() {
                    if (this.fromDate) {
                        this.disabled = false;
                        let from_date = new Date(this.fromDate);
                        if (this.toDate) {
                            let time_difference = new Date(this.toDate).getTime() - from_date.getTime();

                            // if selected days more than 30 then manually modifying the to date to 30
                            if (time_difference / (1000 * 3600 * 24) > 30) {
                                this.toDate = moment(new Date(from_date.setDate(from_date.getDate() + 30)))
                                    .format("YYYY-MM-DD");
                                this.maxDate = this.toDate;
                            }
                            // else setting up the max days to 30
                            else this.maxDate = moment(new Date(from_date.setDate(from_date.getDate() +
                                30))).format("YYYY-MM-DD");
                            if (this.tabType == "analytics") this.generateBarAnalytics();
                            else if (this.tabType == "ninjacontent") this.showContentReports();
                            else if (this.tabType == "ninjaseo") this.showSEOReports();
                            else if (this.tabType == "outreachly") this.showOutreachlyReports();
                            else if (this.tabType == "ninjachat") this.showNinjachatReports();
                            else if (this.tabType == "support") this.showSupportReports();
                            else if (this.tabType == "projectsly") this.show_projectsly_reports();
                            else {
                                this.generateReport();
                                this.pieChartData();
                                await this.reportsByCategory();
                            }
                        }
                    }
                },
                generateReport() {
                    if (this.fromDate && this.toDate) {
                        const self = this;
                        self.isBusy = true;
                        self.emptyState = false;

                        fetch(
                            `https://api.500apps.com/500apps/signup/report?from_date=${moment(this.fromDate).format("YYYY-MM-DD")}&to_date=${moment(this.toDate).format("YYYY-MM-DD")}&region=${this.region}`, {
                            method: "GET",
                            headers: {
                                Accept: "application/json",
                                "Content-Type": "application/json",
                                authorization: "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOiIxNjk4NjU5NjUyIiwidGVuYW50X2lkIjoxLCJ1c2VyX2lkIjoxOTAsImVtYWlsIjoiYWhhbHlhLmtoYW1tYW1ANTAwYXBwcy5jb20iLCJlbnYiOiJkZXYiLCJzdWJzY3JpYmVkIjoibm8ifQ.uEMNpmMpkTlB7I37lCk-oXqkbC8Ajgs80PFH6F9UFM4",
                            },
                        })
                            .then(function (response) {
                                return response.json();
                            })
                            .then(function (data) {
                                self.isBusy = false;

                                if (data.length == 0) self.emptyState = true;
                                var signupsCount = [];
                                this.totalSignupCount = 0;
                                data.filter((item) => {
                                    this.totalSignupCount = this.totalSignupCount + item.count;
                                    signupsCount.push({
                                        name: item.date,
                                        y: item.count
                                    });
                                });

                                Highcharts.chart("container-highcharts", {
                                    chart: {
                                        type: "column",
                                    },
                                    title: {
                                        text: `Total Signups : ${this.totalSignupCount}`,
                                    },
                                    accessibility: {
                                        announceNewData: {
                                            enabled: true,
                                        },
                                    },
                                    xAxis: {
                                        type: "category",
                                    },
                                    yAxis: {
                                        title: {
                                            text: "Count",
                                        },
                                    },

                                    plotOptions: {
                                        series: {
                                            borderWidth: 0,
                                            dataLabels: {
                                                enabled: true,
                                                format: "{point.y}",
                                            },
                                        },
                                    },

                                    tooltip: {
                                        backgroundColor: "#FFF",
                                        borderColor: "#CCC",
                                        borderRadius: 4,
                                        borderWidth: 1,
                                        headerFormat: '<span style="font-size:14px;">{series.name}</span><br>',
                                        pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y}</b> of total<br/>',
                                    },
                                    series: [{
                                        name: "Date",
                                        colorByPoint: true,
                                        data: signupsCount,
                                    },],
                                    credits: {
                                        enabled: false,
                                    },
                                });
                            });
                    }
                },
                pieChartData() {
                    const self = this;
                    self.dataSet = [];
                    self.isBusy = true;
                    self.totalRegionsCount = 0;
                    self.regions.map((region, index) => {
                        if (region && region.value) {
                            fetch(
                                `https://api.500apps.com/500apps/signup/report?from_date=${moment(this.fromDate).format("YYYY-MM-DD")}&to_date=${moment(this.toDate).format("YYYY-MM-DD")}&region=${region.value}`, {
                                method: "GET",
                                headers: {
                                    Accept: "application/json",
                                    "Content-Type": "application/json",
                                    authorization: "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOiIxNjk4NjU5NjUyIiwidGVuYW50X2lkIjoxLCJ1c2VyX2lkIjoxOTAsImVtYWlsIjoiYWhhbHlhLmtoYW1tYW1ANTAwYXBwcy5jb20iLCJlbnYiOiJkZXYiLCJzdWJzY3JpYmVkIjoibm8ifQ.uEMNpmMpkTlB7I37lCk-oXqkbC8Ajgs80PFH6F9UFM4",
                                },
                            },
                            )
                                .then(function (response) {
                                    return response.json();
                                })
                                .then(function (data) {
                                    self.isBusy = false;

                                    var totalSignupCount = 0;
                                    data.filter((item) => {
                                        totalSignupCount = totalSignupCount + item.count;
                                        self.totalRegionsCount = self.totalRegionsCount +
                                            item.count;
                                    });
                                    self.dataSet.push({
                                        name: region.text,
                                        y: totalSignupCount
                                    });
                                    if (self.dataSet.length == self.regions.length - 1) self
                                        .generateRegionReport();
                                });
                        }
                    });
                },
                generateRegionReport() {
                    Highcharts.chart("container-pie", {
                        chart: {
                            plotBackgroundColor: null,
                            plotBorderWidth: null,
                            plotShadow: false,
                            type: "pie",
                        },
                        title: {
                            text: `Total Signups : ${this.totalRegionsCount}`,
                        },
                        accessibility: {
                            point: {
                                valueSuffix: "%",
                            },
                        },
                        plotOptions: {
                            pie: {
                                allowPointSelect: true,
                                cursor: "pointer",
                                dataLabels: {
                                    enabled: true,
                                    format: "<b>{point.name}</b>: {point.y}",
                                },
                            },
                        },
                        series: [{
                            name: "Total Signups",
                            colorByPoint: true,
                            data: this.dataSet,
                        },],
                        credits: {
                            enabled: false,
                        },
                    });
                },
                generateReportByType(type, data, count) {
                    const self = this;
                    if (type == "browser_type" && !count) this.hideBrowserReport = true;
                    else if (type == "device_type" && !count) this.hideDeviceReport = true;
                    else if (type == "app_name" && !count) this.hideAppsReport = true;
                    else if (type == "country" && !count) this.hideCountryReport = true;
                    else if (type == "auth_type" && !count) this.hideAuthReport = true;
                    let title;
                    if (type.includes("ninjacontent") || type.includes("ninjaseo") || type.includes(
                        "ninjachat")) title = `${type.split("-")[1].replace("_", " ")} Total Count : ${count}`;
                    else if (type.includes('support')) title = `${data.name} Total Ticket Count:${count}`
                    else type.includes("analytic") ? (title = `${type.split("-")[1]} wise users : ${count}`) : (
                        title = `${type.split("_")[0]} wise signups count : ${count}`);
                    let totalCountText;
                    if (type.includes("ninjacontent") || type.includes("ninjaseo") || type.includes(
                        "ninjachat") || type.includes("outreachly")) totalCountText = `Total Count`;
                    else type.includes("analytic") ? (totalCountText = "Total Users") : (totalCountText =
                        "Total Signups");
                    if (type == "app_wise_users") title = `Inside App Users : ${count}`;
                    if (type.includes("outreachly")) {
                        title = "";
                        title = `${type.split("-")[1].replaceAll("_", " ")} : ${count}`
                    }


                    Highcharts.chart(`container-pie-${type}`, {
                        chart: {
                            plotBackgroundColor: null,
                            plotBorderWidth: null,
                            plotShadow: false,
                            type: "pie",
                        },
                        title: {
                            text: title,
                        },
                        accessibility: {
                            point: {
                                valueSuffix: "%",
                            },
                        },
                        plotOptions: {
                            pie: {
                                allowPointSelect: true,
                                cumulative: -0.25,
                                precision: 1000,
                                cursor: "pointer",
                                slicedOffset: 20,
                                dataLabels: {
                                    enabled: true,
                                    rotation: 1,
                                    format: '<b>{point.name}</b>: {point.y}',
                                },
                            },
                        },
                        series: [{
                            name: `${totalCountText}`,
                            colorByPoint: true,
                            data: data.reportData,
                            point: {
                                events: {
                                    click: function (event) {
                                        if (type.includes("live_contents")) self
                                            .displayContentList(this);
                                        // else if (type.includes("page_grader")) self.displaySEOList(this, "page_grader");
                                        // else if (type.includes("rankings")) self.displaySEOList(this, "rankings");
                                        // else if (type.includes("link_tracking")) self.displaySEOList(this, "link_tracking");
                                        else self.contentUrls = [];
                                    },
                                },
                            },
                        },],
                        credits: {
                            enabled: false,
                        },
                    });
                },
                getReportDataByType(type, is_custom_data) {
                    if (this.fromDate && this.toDate) {
                        const self = this;
                        self.isBusy = true;
                        let params;
                        is_custom_data ? (params = `${type}=true`) : (params = `type=${type}`);

                        fetch(
                            `${this.host}/500apps/signup/report?from_date=${moment(this.fromDate).format("YYYY-MM-DD")}&to_date=${moment(this.toDate).format("YYYY-MM-DD")}&${params}`, {
                            method: "GET",
                            headers: {
                                Accept: "application/json",
                                "Content-Type": "application/json",
                                authorization: "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOiIxNjk4NjU5NjUyIiwidGVuYW50X2lkIjoxLCJ1c2VyX2lkIjoxOTAsImVtYWlsIjoiYWhhbHlhLmtoYW1tYW1ANTAwYXBwcy5jb20iLCJlbnYiOiJkZXYiLCJzdWJzY3JpYmVkIjoibm8ifQ.uEMNpmMpkTlB7I37lCk-oXqkbC8Ajgs80PFH6F9UFM4",
                            },
                        })
                            .then(function (response) {
                                return response.json();
                            })
                            .then(function (data) {
                                self.isBusy = false;

                                var dataSet = [];
                                var totalSignupCount = 0;
                                if (data && data.error) return;
                                data.filter((item) => {
                                    if (type == "app_wise_users") {
                                        totalSignupCount = totalSignupCount + item.users_count;
                                        dataSet.push({
                                            name: item.app_name,
                                            y: item.users_count
                                        });
                                    } else if (type == "domain_wise") {
                                        totalSignupCount = totalSignupCount + parseInt(item[
                                            "gmail"]) + parseInt(item["non-gmail"]);
                                        dataSet.push({
                                            name: "gmail",
                                            y: parseInt(item["gmail"])
                                        });
                                        dataSet.push({
                                            name: "non-gmail",
                                            y: parseInt(item["non-gmail"])
                                        });
                                    } else {
                                        totalSignupCount = totalSignupCount + item.count;
                                        dataSet.push({
                                            name: item.name.substring(0, 50),
                                            y: item.count
                                        });
                                    }
                                });
                                var reportData = {
                                    totalSignupCount: totalSignupCount,
                                    reportData: dataSet
                                };
                                if (type == "device_type") self.deviceReort = reportData;
                                else if (type == "app_name") self.appsReport = reportData;
                                else if (type == "browser_type") self.browserReport = reportData;
                                else if (type == "auth_type") self.authReport = reportData;
                                else if (type == "country") self.countryReport = reportData;
                                self.generateReportByType(type, reportData, totalSignupCount);
                            });
                    }
                },
                async reportsByCategory() {
                    this.hideBrowserReport = false;
                    this.hideDeviceReport = false;
                    this.hideAppsReport = false;
                    this.hideCountryReport = false;
                    this.hideAuthReport = false;
                    await this.getReportDataByType("browser_type");
                    await this.getReportDataByType("device_type");
                    await this.getReportDataByType("app_name");
                    await this.getReportDataByType("country");
                    await this.getReportDataByType("auth_type");
                    await this.getReportDataByType("domain_wise", true);
                    await this.getReportDataByType("app_wise_users", true);
                },
                async comparisonChart(reportFor, fromDate, toDate) {
                    const self = this;
                    self.isComparisionLoading = true;
                    fetch(
                        `https://api.500apps.com/500apps/signup/report?from_date=${moment(toDate).format("YYYY-MM-DD")}&to_date=${moment(fromDate).format("YYYY-MM-DD")}&region=${reportFor.value}&week=true`, {
                        method: "GET",
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json",
                            authorization: "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOiIxNjk4NjU5NjUyIiwidGVuYW50X2lkIjoxLCJ1c2VyX2lkIjoxOTAsImVtYWlsIjoiYWhhbHlhLmtoYW1tYW1ANTAwYXBwcy5jb20iLCJlbnYiOiJkZXYiLCJzdWJzY3JpYmVkIjoibm8ifQ.uEMNpmMpkTlB7I37lCk-oXqkbC8Ajgs80PFH6F9UFM4",
                        },
                    },
                    )
                        .then(function (response) {
                            return response.json();
                        })
                        .then(function (data) {
                            var dataSet = [];
                            var totalSignupCount = 0;
                            if (!data || !data.length) return;

                            data.filter((item, i) => {
                                totalSignupCount = totalSignupCount + item.count;
                                let label;
                                // if (Math.floor(new Date(item.created_date).getDate() / 7)) label = Math.floor(new Date(item.created_date).getDate() / 7) + 1;
                                // else label = "1";
                                dataSet.push({
                                    name: "Week " + (i + 1) +
                                        ` (${moment(item.created_date).format("ll")})`,
                                    y: item.count
                                });
                            });
                            var reportData = {
                                totalSignupCount: totalSignupCount,
                                reportData: dataSet
                            };
                            let type;
                            type = reportFor.text == "All" ? "all" : reportFor.value;
                            self.generateLineChart(type, reportData, totalSignupCount, reportFor.text);
                            self.isComparisionLoading = false;
                        });
                },
                async generateLineChart(type, dataSet, totalCount, key, chart_type, title) {
                    this.isBusy = true;
                    var colors = Highcharts.getOptions().colors;
                    if (!title) {
                        if (chart_type == "analytics" || chart_type == "sessionSource" || chart_type ==
                            "signup") {
                            key != "All" ? (title = `${key} Users : ${totalCount}`) : (title =
                                `Total Users : ${totalCount}`);
                        } else {
                            chart_type = "line";
                            key != "All" ? (title = `${key} Total Signups : ${totalCount}`) : (title =
                                `Total Signups : ${totalCount}`);
                        }
                    } else {
                        title = `${title} : ${totalCount} `;
                    }

                    Highcharts.chart(`container-${chart_type}-${type}`, {
                        chart: {
                            type: "line",
                        },
                        title: {
                            text: title,
                        },
                        accessibility: {
                            announceNewData: {
                                enabled: true,
                            },
                        },
                        xAxis: {
                            type: "category",
                        },
                        yAxis: {
                            title: {
                                text: "Count",
                            },
                        },
                        plotOptions: {
                            series: {
                                borderWidth: 0,
                                allowPointSelect: true,
                                cursor: "pointer",
                                dataLabels: {
                                    enabled: true,
                                    format: "{point.y}",
                                },
                                label: {
                                    connectorAllowed: false,
                                },
                            },
                        },
                        tooltip: {
                            backgroundColor: "#FFF",
                            borderColor: "#CCC",
                            borderRadius: 4,
                            borderWidth: 1,
                            headerFormat: '<span style="font-size:14px;">{series.name}</span><br>',
                            pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y}</b> of total<br/>',
                        },
                        series: [{
                            name: `${chart_type == "sessionSource" ? "Session Source" : "Date"}`,
                            colorByPoint: true,
                            cursor: "pointer",
                            type: "coloredline",
                            data: dataSet.reportData.reverse().map((v, i) => {
                                let index = i - 10;
                                if (i - 10 > 10) index = i - 20;
                                else if (i - 10 < 0) index = i;
                                return {
                                    y: v.y,
                                    name: v.name,
                                    segmentColor: colors[index],
                                    color: colors[index]
                                };
                            }),
                        },],

                        responsive: {
                            rules: [{
                                condition: {
                                    maxWidth: 500,
                                },
                                chartOptions: {
                                    legend: {
                                        layout: "horizontal",
                                        align: "center",
                                        verticalAlign: "bottom",
                                    },
                                },
                            },],
                        },
                    });
                    this.isBusy = false;
                },
                async showComparisions(type) {
                    self.isComparisionLoading = true;
                    this.hideAllTypeLineReport = this.hideAp1TypeLineReport = this.hideAp2TypeLineReport =
                        this.hideUs1TypeLineReport = this.hideUs2TypeLineReport = this
                            .hideSa1TypeLineReport = this.hideEu1TypeLineReport = false;
                    let from_date = new Date();
                    let to_date = new Date();
                    from_date.setDate(from_date.getDate() + 1);
                    to_date.setDate(to_date.getDate() - 50 * 7);
                    if (type == "analytics") {
                        for (let i = 0; i < this.continentList.length; i++) {
                            await this.showAnalyticsComparisions(this.continentList[i], from_date, to_date);
                        }
                    } else if (type == "signup") {
                        this.showAllAppsOnce = false;
                        this.getListOfAppsAtOnce("signup", from_date, to_date);
                    } else {
                        for (let i = 0; i < this.regions.length; i++) {
                            await this.comparisonChart(this.regions[i], from_date, "2021-07-01");
                        }
                    }

                    self.isComparisionLoading = false;
                },
                async showAnalyticsComparisions(reportFor, fromDate, toDate) {
                    const self = this;
                    self.isComparisionLoading = true;
                    let url;
                    reportFor.text == "All" ?
                        (url =
                            `${this.host}/500apps/v1/google/analytics?from_date=${moment(toDate).format("YYYY-MM-DD")}&to_date=${moment(fromDate).format("YYYY-MM-DD")}&type=week`
                        ) :
                        (url = `${this.host}/500apps/v1/google/analytics?from_date=${moment(toDate).format("YYYY-MM-DD")}&to_date=${moment(fromDate).format("YYYY-MM-DD")}&type=country&country=${reportFor.value
                            }`);
                    fetch(url, {
                        method: "GET",
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json",
                            authorization: "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOiIxNjk4NjU5NjUyIiwidGVuYW50X2lkIjoxLCJ1c2VyX2lkIjoxOTAsImVtYWlsIjoiYWhhbHlhLmtoYW1tYW1ANTAwYXBwcy5jb20iLCJlbnYiOiJkZXYiLCJzdWJzY3JpYmVkIjoibm8ifQ.uEMNpmMpkTlB7I37lCk-oXqkbC8Ajgs80PFH6F9UFM4",
                        },
                    })
                        .then(function (response) {
                            return response.json();
                        })
                        .then(function (data) {
                            var dataSet = [];
                            var totalSignupCount = 0;
                            if (!data || !data.length) return;
                            data.sort((first_value, second_value) => {
                                let from_date = new Date(first_value.date);
                                let to_date = new Date(second_value.date);
                                if (from_date.getTime() > to_date.getTime()) return -1;
                                else if (from_date.getTime() < to_date.getTime()) return 1;
                                else return 0;
                            });
                            data.filter((item, i) => {
                                totalSignupCount = totalSignupCount + item.users;
                                let label;
                                // if (Math.floor(new Date(item.date).getDate() / 7)) label = Math.floor(new Date(item.date).getDate() / 7) + 1;
                                // else label = "1";
                                dataSet.push({
                                    name: "Week " + (i + 1) +
                                        ` (${moment(item.date).format("ll")})`,
                                    y: item.users
                                });
                            });
                            var reportData = {
                                totalSignupCount: totalSignupCount,
                                reportData: dataSet
                            };
                            let type;
                            type = reportFor.text == "All" ? "all" : reportFor.value;
                            self.generateLineChart(type, reportData, totalSignupCount, reportFor.text,
                                "analytics");
                            self.isComparisionLoading = false;
                        });
                },
                generateAnalytics() {
                    const self = this;
                    self.isBusy = true;
                    self.hideAnalyticsReport = true;
                    self.analyticsList.map((analytic, index) => {
                        fetch(
                            `${this.host}/500apps/v1/google/analytics?from_date=${moment(this.fromDate).format("YYYY-MM-DD")}&to_date=${moment(this.toDate).format("YYYY-MM-DD")}&type=${analytic.value}`, {
                            method: "GET",
                            headers: {
                                Accept: "application/json",
                                "Content-Type": "application/json",
                                authorization: "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOiIxNjk4NjU5NjUyIiwidGVuYW50X2lkIjoxLCJ1c2VyX2lkIjoxOTAsImVtYWlsIjoiYWhhbHlhLmtoYW1tYW1ANTAwYXBwcy5jb20iLCJlbnYiOiJkZXYiLCJzdWJzY3JpYmVkIjoibm8ifQ.uEMNpmMpkTlB7I37lCk-oXqkbC8Ajgs80PFH6F9UFM4",
                            },
                        })
                            .then(function (response) {
                                return response.json();
                            })
                            .then(function (data) {
                                self.isBusy = false;
                                if (data.length == 0) return (self.emptyState = true);
                                var dataSet = [];
                                var totalSignupCount = 0;
                                if (analytic.value == "app") self.appsList = [];
                                self.showAllAppsOnce = false;
                                data.filter((item) => {
                                    totalSignupCount = totalSignupCount + item.users;
                                    dataSet.push({
                                        name: item[analytic.value],
                                        y: item.users
                                    });
                                    if (analytic.value == "app") self.appsList.push(item[
                                        analytic.value]);
                                });
                                var reportData = {
                                    totalSignupCount: totalSignupCount,
                                    reportData: dataSet
                                };
                                self.generateReportByType(`analytics-${analytic.value}`, reportData,
                                    totalSignupCount);
                                if (analytic.value == "app") self.getListOfAppsAtOnce();
                                self.showAllAppsOnce = true;
                                self.hideAnalyticsReport = false;
                            });
                    });
                },
                barChartConfig(totalSignupCount, dataSet, xAxisLabel, title, chat_name) {
                    Highcharts.chart(`container-bar-${chat_name}`, {
                        chart: {
                            type: "column",
                        },
                        title: {
                            text: `${title} Users : ${totalSignupCount}`,
                        },
                        accessibility: {
                            announceNewData: {
                                enabled: true,
                            },
                        },
                        xAxis: {
                            type: "category",
                        },
                        yAxis: {
                            title: {
                                text: "Count",
                            },
                        },

                        plotOptions: {
                            series: {
                                borderWidth: 0,
                                dataLabels: {
                                    enabled: true,
                                    format: "{point.y}",
                                },
                            },
                        },

                        tooltip: {
                            backgroundColor: "#FFF",
                            borderColor: "#CCC",
                            borderRadius: 4,
                            borderWidth: 1,
                            headerFormat: '<span style="font-size:14px;">{series.name}</span><br>',
                            pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y}</b> of total<br/>',
                        },
                        series: [{
                            name: `${xAxisLabel}`,
                            colorByPoint: true,
                            data: dataSet,
                        },],
                        credits: {
                            enabled: false,
                        },
                    });
                },
                generateBarAnalytics() {
                    if (this.fromDate && this.toDate) {
                        const self = this;
                        self.hideAnalyticsReport = true;
                        self.generateAnalytics();
                        fetch(
                            `${this.host}/500apps/v1/google/analytics?from_date=${moment(this.fromDate).format("YYYY-MM-DD")}&to_date=${moment(this.toDate).format("YYYY-MM-DD")}`, {
                            method: "GET",
                            headers: {
                                Accept: "application/json",
                                "Content-Type": "application/json",
                                authorization: "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOiIxNjk4NjU5NjUyIiwidGVuYW50X2lkIjoxLCJ1c2VyX2lkIjoxOTAsImVtYWlsIjoiYWhhbHlhLmtoYW1tYW1ANTAwYXBwcy5jb20iLCJlbnYiOiJkZXYiLCJzdWJzY3JpYmVkIjoibm8ifQ.uEMNpmMpkTlB7I37lCk-oXqkbC8Ajgs80PFH6F9UFM4",
                            },
                        })
                            .then(function (response) {
                                return response.json();
                            })
                            .then(function (data) {
                                self.isBusy = false;
                                var dataSet = [];
                                var totalSignupCount = 0;
                                if (data.length == 0) return (self.emptyState = true);
                                data.filter((item) => {
                                    totalSignupCount = totalSignupCount + item.users;
                                    dataSet.push({
                                        name: moment(item.date).format("YYYY-MM-DD"),
                                        y: item.users
                                    });
                                });
                                var reportData = {
                                    totalSignupCount: totalSignupCount,
                                    reportData: dataSet
                                };
                                self.barChartConfig(totalSignupCount, dataSet, "Date", "Total",
                                    "analytics-date");
                            });
                        self.hideAnalyticsReport = false;
                    }
                },
                async getListOfAppsAtOnce(type, toDate, fromDate) {
                    const self = this;
                    self.isBusy = true;
                    let report_type, key_type, url;
                    if (type == "signup") {
                        self.appsList = [];
                        self.showAllAppsOnce = false;
                        url =
                            `${this.host}/500apps/signup/report?apps_weekly_wise=true&from_date=${moment(fromDate).format("YYYY-MM-DD")}&to_date=${moment(toDate).format("YYYY-MM-DD")}`;
                        //  ${this.host}/500apps/signup/report?apps_weekly_wise=true&from_date=01-02-2021&to_date=03-02-2022
                    } else {
                        if (type) (report_type = "sessionSource"), (key_type = "sessionSource");
                        else (report_type = "app"), (key_type = "date");
                        url = `${this.host}/500apps/v1/google/analytics?from_date=${moment(this.fromDate).format("YYYY-MM-DD")}&to_date=${moment(this.toDate).format(
                            "YYYY-MM-DD",
                        )}&type=${report_type}&each_app=true`;
                    }
                    fetch(url, {
                        method: "GET",
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json",
                            authorization: "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOiIxNjk4NjU5NjUyIiwidGVuYW50X2lkIjoxLCJ1c2VyX2lkIjoxOTAsImVtYWlsIjoiYWhhbHlhLmtoYW1tYW1ANTAwYXBwcy5jb20iLCJlbnYiOiJkZXYiLCJzdWJzY3JpYmVkIjoibm8ifQ.uEMNpmMpkTlB7I37lCk-oXqkbC8Ajgs80PFH6F9UFM4",
                        },
                    })
                        .then(function (response) {
                            return response.json();
                        })
                        .then(function (data) {
                            self.isBusy = false;
                            if (type == "signup") {
                                self.appsList = Object.keys(data);
                                self.showAllAppsOnce = true;
                                setTimeout(() => {
                                    self.appsList.filter((app_name) => {
                                        if (!data || !data[app_name]) return;
                                        var dataSet = [];
                                        var totalSignupCount = 0;
                                        data[app_name].filter((item, i) => {
                                            totalSignupCount =
                                                totalSignupCount + item.count;
                                            dataSet.push({
                                                name: "Week " + (i +
                                                    1) +
                                                    ` (${moment(item.created_date).format("ll")})`,
                                                y: item.count
                                            });
                                        });
                                        var reportData = {
                                            totalSignupCount: totalSignupCount,
                                            reportData: type ? dataSet : dataSet
                                                .reverse()
                                        };
                                        self.generateLineChart(app_name, reportData,
                                            totalSignupCount, app_name, "signup");
                                    });
                                }, 1000);
                            } else {
                                self.appsList.filter((app_name) => {
                                    if (!data || !data[app_name]) return;
                                    var dataSet = [];
                                    var totalSignupCount = 0;
                                    data[app_name].filter((item) => {
                                        totalSignupCount = totalSignupCount + item
                                            .users;
                                        dataSet.push({
                                            name: item[key_type],
                                            y: item.users
                                        });
                                    });
                                    var reportData = {
                                        totalSignupCount: totalSignupCount,
                                        reportData: type ? dataSet : dataSet.reverse()
                                    };
                                    self.generateLineChart(app_name, reportData,
                                        totalSignupCount, app_name, type ? "sessionSource" :
                                        "analytics");
                                });
                            }
                        });
                },
                async showContentReports() {
                    const self = this;
                    self.isBusy = true;
                    self.emptyState = true;
                    self.hideContentURlsList = false;
                    self.hideLiveConent = false;
                    self.hideDistributionStats = false;
                    self.ninjaContentList.map((content_type, index) => {
                        let restDomain;
                        let token;
                        window.location.href.includes("env=dev") ?
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InNyYXZhbmkuc2V0dGlwYWxsaStsb2NhbEA1MDBhcHBzLmNvbSIsInRlbmFudF9pZCI6Mjg0MSwidXNlcl9pZCI6NzgyMywic3Vic2NyaWJlZCI6InllcyIsImV4cCI6IjE2NTA2MTgxOTciLCJlbnYiOiJkZXYifQ.I6CZ6k3TwLLGnuYC4tiNbLiP3vYh0Jjocz2NQ4siLmM"
                            ) :
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6ImFoYWx5YS5raGFtYmhhbUA1MDBhcHBzLmNvbSIsInRlbmFudF9pZCI6MTM0MTYsInVzZXJfaWQiOjE4NTI0LCJleHAiOiIxNzA4NTkzNzY5IiwiZW52IjoiYXAxIn0.01b5czaEWr0gwstXWCsP3SdTsfANhnkkXZeyDHeHVa0"
                            );
                        content_type.value == "live_contents" ?
                            (restDomain =
                                `v2c/ninjacontent/check_content_count?where=date(c.created_date) between '${self.fromDate}' and '${self.toDate}'`
                            ) :
                            (restDomain =
                                `v2c/ninjacontent/check_content_distribution_details?where=date(cd.created_date) between '${self.fromDate}' and '${self.toDate}'`
                            );

                        let host_name = window.location.href.includes("env=dev") ?
                            "https://api.dev.500apps.com" :
                            "https://api.ap1.500apps.com"; //Set host

                        fetch(`${host_name}/${restDomain}`, {
                            method: "GET",
                            headers: {
                                Accept: "application/json",
                                "Content-Type": "application/json",
                                authorization: `Bearer ${token}`,
                            },
                        })
                            .then(function (response) {
                                return response.json();
                            })
                            .then(function (data) {
                                self.emptyState = false;
                                self.isBusy = false;
                                if (data.length == 0) return (self.emptyState = true),
                                    content_type.value == "live_contents" ? (self
                                        .hideLiveConent = true) : (self
                                            .hideDistributionStats = true);

                                var dataSet = [];
                                var totalSignupCount = 0;
                                data.filter((item) => {
                                    totalSignupCount = totalSignupCount + parseInt(item
                                        .count);
                                    dataSet.push({
                                        name: item.website_url,
                                        y: parseInt(item.count),
                                        data: item
                                    });
                                });
                                var reportData = {
                                    totalSignupCount: totalSignupCount,
                                    reportData: dataSet
                                };
                                self.generateReportByType(`ninjacontent-${content_type.value}`,
                                    reportData, totalSignupCount);
                            });
                    });
                },
                displayContentList(data) {
                    const self = this;
                    self.loadContentData = true;
                    self.hideContentURlsList = false;
                    self.contentUrls = [];
                    window.location.href.includes("env=dev") ?
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InNyYXZhbmkuc2V0dGlwYWxsaStsb2NhbEA1MDBhcHBzLmNvbSIsInRlbmFudF9pZCI6Mjg0MSwidXNlcl9pZCI6NzgyMywic3Vic2NyaWJlZCI6InllcyIsImV4cCI6IjE2NTA2MTgxOTciLCJlbnYiOiJkZXYifQ.I6CZ6k3TwLLGnuYC4tiNbLiP3vYh0Jjocz2NQ4siLmM"
                        ) :
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6ImFoYWx5YS5raGFtYmhhbUA1MDBhcHBzLmNvbSIsInRlbmFudF9pZCI6MTM0MTYsInVzZXJfaWQiOjE4NTI0LCJleHAiOiIxNzA4NTkzNzY5IiwiZW52IjoiYXAxIn0.01b5czaEWr0gwstXWCsP3SdTsfANhnkkXZeyDHeHVa0"
                        );

                    restDomain =
                        `v2/500content/domain/website_content_details?fields=concat(website_url,url) as url&where=website_id='${data.data.website_id}' AND date(created_date) between '${self.fromDate}' and '${self.toDate}' and  status='Live'`;

                    let host_name = window.location.href.includes("env=dev") ? "https://api.dev.500apps.com" :
                        "https://api.ap1.500apps.com"; //Set host

                    fetch(`${host_name}/${restDomain}`, {
                        method: "GET",
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json",
                            authorization: `Bearer ${token}`,
                        },
                    })
                        .then(function (response) {
                            return response.json();
                        })
                        .then(function (data) {
                            self.loadContentData = false;
                            self.contentUrls = data;
                            self.hideContentURlsList = true;
                        });
                },
                // Fetch data when tab changed
                seoTabActivated(newTabIndex, prevTabIndex, event) {
                    var self = this;
                    self.currentSeoTabIndex = newTabIndex;
                    var tabName = event.vueTarget.tabs[newTabIndex].id;
                    if (!self.seoTableData[tabName].length) {
                        var count = 0;
                        self.seoURLsData[tabName].forEach((item, index) => {
                            if (index < self.scrollCount) {
                                try {
                                    self.getSEOTableData(tabName, item.name);
                                } catch (err) {
                                    console.log(err);
                                }
                            }
                        });
                    }
                },
                async showSEOReports() {
                    const self = this;
                    self.isBusy = true;
                    self.emptyState = true;
                    self.hideContentURlsList = false;
                    self.hidePageGrader = false;
                    self.hideRankings = false;
                    self.hideLinkTracking = false;
                    self.RankingsDomainCount = "";
                    self.ninjaSEOList.map((content_type, index) => {
                        self.seoTableData[content_type.value] = [];
                        let restDomain;
                        let token;
                        window.location.href.includes("env=dev") ?
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InNyaXJhbS5wb3RodXJhanVANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjQ2NDQsInVzZXJfaWQiOjE0OTkwLCJleHAiOiIxNzA0ODcxODE0IiwiZW52IjoiZGV2In0.cqWr8NkV5Uc-A9dfMqGBXZoELZR77KsUNHoWLOLPJIg"
                            ) :
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InJhd2liYWJidS5kYWtvanVANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjEzNDE2LCJ1c2VyX2lkIjoxODQxMSwic3Vic2NyaWJlZCI6Im5vIiwiZXhwIjoiMTY1MjEwNzczNyIsImVudiI6ImFwMSJ9.eFL8jtuSsupX2lAdewU0-VZvedA_CB7drmEms_NldeU"
                            );
                        if (content_type.value == "page_grader") {
                            restDomain =
                                `v2/ninjaseo/domain/page_graders?fields=distinct(substring_index(domain_url,'/',3)) as website_url,count(*) as count&${this.timeFormat()}&group_by=keyword`;
                        } else if (content_type.value == "rankings") {
                            restDomain =
                                `v2/ninjaseo/domain/rankings?fields=id,url as website_url,count(distinct%20keywords)%20as%20count&${this.timeFormat()} &group_by=url`;
                        } else {
                            restDomain =
                                `v2/ninjaseo/domain/link_trackings?fields=id,site_url as website_url,count(distinct%20keyword)%20as%20count&${this.timeFormat()} &group_by=site_url`;
                        }

                        let host_name = window.location.href.includes("env=dev") ?
                            "https://api.dev.500apps.com" :
                            "https://api.ap1.500apps.com"; //Set host

                        fetch(`${host_name}/${restDomain}`, {
                            method: "GET",
                            headers: {
                                Accept: "application/json",
                                "Content-Type": "application/json",
                                authorization: `Bearer ${token}`,
                            },
                        })
                            .then(function (response) {
                                return response.json();
                            })
                            .then(function (data) {
                                self.emptyState = false;
                                self.isBusy = false;
                                if (data.length == 0) {
                                    self.emptyState = true;
                                    if (content_type.value == "page_grader") self
                                        .hidePageGrader = true;
                                    else if (content_type.value == "rankings") self
                                        .hideRankings = true;
                                    else self.hideLinkTracking = true;
                                    return;
                                }

                                var dataSet = [];
                                var totalSignupCount = 0;
                                data.filter((item) => {
                                    totalSignupCount = totalSignupCount + parseInt(item
                                        .count);
                                    dataSet.push({
                                        name: item.website_url,
                                        y: parseInt(item.count),
                                        data: item
                                    });
                                });
                                self.getSEOStatistics(content_type.value, totalSignupCount);
                                var reportData = {
                                    totalSignupCount: totalSignupCount,
                                    reportData: dataSet
                                };
                                self.seoURLsData[content_type.value] = dataSet;
                                self.generateReportByType(`ninjaseo-${content_type.value}`,
                                    reportData, totalSignupCount);
                                if (self.currentSeoTabIndex === index) {
                                    dataSet.forEach((item, index) => {
                                        if (index < self.scrollCount) {
                                            try {
                                                self.getSEOTableData(content_type.value,
                                                    item.name);
                                            } catch (err) {
                                                console.log(err);
                                            }
                                        }
                                    });
                                }
                            });
                    });
                    self.getSEOStatistics("keywords_count");
                },
                async showOutreachlyReports() {
                    const self = this;
                    self.isBusy = true;
                    self.emptyState = true;
                    self.hideContentURlsList = false;
                    self.hideTotalProspects = false;
                    self.hideTotalTasks = false;
                    self.hideTotalCalls = false;
                    self.hideTotalEmails = false;
                    self.outreachlyList.map((content_type, index) => {
                        let restDomain;
                        let token;
                        window.location.href.includes("env=dev") ?
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InJhaHVsLnZhbmFnYXJpQDUwMGFwcHMuY29tIiwidGVuYW50X2lkIjo1NjYzLCJ1c2VyX2lkIjoxNzEwNCwic3Vic2NyaWJlZCI6Im5vIiwiZXhwIjoiMTY1MjUyMTE2NCIsImVudiI6ImRldiJ9.zDgpJIgqEIdVp1omS_lr6pXGBpeinV4FSwN4EE4T8mo"
                            ) :
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InJhaHVsLnZhbmFnYXJpQDUwMGFwcHMuY29tIiwidGVuYW50X2lkIjoxMzQxNiwidXNlcl9pZCI6MTg0ODYsInN1YnNjcmliZWQiOiJubyIsImV4cCI6IjE2NTE5MjYwMzAiLCJlbnYiOiJhcDEifQ.L-VNvrh9Tj70azJX8WQ6r3v5vZTJ330mgT5LvUEBZN4"
                            );
                        if (content_type.value == 'total_prospects_memberwise') {
                            restDomain =
                                `v2/prospectly/domain/prospects?fields=count(*) as count,created_by as name&group_by=created_by&order_by=count desc&${self.timeFormat()}`
                        } else if (content_type.value == 'total_calls_memberwise') {
                            restDomain =
                                `v2/prospectly/domain/prospect_stats?fields=count(*) as count,created_by as name&group_by=created_by&order_by=count desc&${self.timeFormat()} and type='Call'`
                        } else if (content_type.value == 'total_emails_memberwise') {
                            restDomain =
                                `v2/prospectly/domain/prospect_stats?fields=count(*) as count,created_by as name&group_by=created_by&order_by=count desc&${self.timeFormat()} and type='Email'`
                        } else if (content_type.value == 'total_tasks_memberwise') {
                            restDomain =
                                `v2/prospectly/domain/tasks?fields=count(*) as count,owner as name&group_by=owner&order_by=count desc&${self.timeFormat()}`
                        } else if (content_type.value == 'total_tasks_open_memberwise') {
                            restDomain =
                                `v2/prospectly/domain/tasks?fields=count(*) as count,owner as name&group_by=owner&order_by=count desc&${self.timeFormat()} and status in ('New','Pending','In Progress')`
                        } else if (content_type.value == 'total_tasks_outstanding_memberwise') {
                            restDomain =
                                `v2/prospectly/domain/tasks?fields=count(*) as count,owner as name&group_by=owner&order_by=count desc&${self.timeFormat()} and status='Outstanding'`
                        } else if (content_type.value == 'total_tasks_closed_memberwise') {
                            restDomain =
                                `v2/prospectly/domain/tasks?fields=count(*) as count,owner as name&group_by=owner&order_by=count desc&${self.timeFormat()} and status='Completed'`
                        } else {
                            restDomain =
                                `v2c/outreachly/${content_type.value}?start_date=${moment(this.fromDate).format("YYYY-MM-DD")}&end_date=${moment(this.toDate).format("YYYY-MM-DD")}&order_by=count desc`
                        }
                        let host_name = window.location.href.includes("env=dev") ?
                            "https://api.dev.500apps.com" :
                            "https://api.ap1.500apps.com"; //Set host
                        fetch(`${host_name}/${restDomain}`, {
                            method: "GET",
                            headers: {
                                Accept: "application/json",
                                "Content-Type": "application/json",
                                authorization: `Bearer ${token}`,
                            },
                        })
                            .then(function (response) {
                                return response.json();
                            })
                            .then(function (data) {
                                self.emptyState = false;
                                self.isBusy = false;
                                if (data.length == 0) {
                                    self.emptyState = true;
                                    content_type.emptyState = true;
                                }
                                if (content_type.value.includes('memberwise')) {
                                    data.map((element) => {
                                        let user = window.Users.find(id => id.id == element.name)
                                        element.name = user?.name ? user.name : 'No Owner'
                                        return element
                                    })
                                }
                                var dataSet = [];
                                var totalSignupCount = 0;
                                data.filter((item) => {
                                    totalSignupCount = totalSignupCount + parseInt(item
                                        .count);
                                    dataSet.push({
                                        name: item.name,
                                        y: parseInt(item.count)
                                    });
                                });
                                var reportData = {
                                    totalSignupCount: totalSignupCount,
                                    reportData: dataSet
                                };
                                self.generateReportByType(`outreachly-${content_type.value}`,
                                    reportData, totalSignupCount);
                            });
                    });
                },
                getSEOTableData(app_name, domain) {
                    let restDomain;
                    let token;
                    window.location.href.includes("env=dev") ?
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InNhaXJhbS5zdW5rYXJhQDUwMGFwcHMuY29tIiwidGVuYW50X2lkIjo0Nzg1LCJ1c2VyX2lkIjoxNTI5Nywic3Vic2NyaWJlZCI6Im5vIiwiZXhwIjoiMTY1MTgzNzIwNyIsImVudiI6ImRldiJ9.eniUdqbsnMtKdJJV36Pmz4upEQc-Yp4CHHGhp2mW-r4"
                        ) :
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InJhd2liYWJidS5kYWtvanVANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjEzNDE2LCJ1c2VyX2lkIjoxODQxMSwic3Vic2NyaWJlZCI6Im5vIiwiZXhwIjoiMTY1MjEwNzczNyIsImVudiI6ImFwMSJ9.eFL8jtuSsupX2lAdewU0-VZvedA_CB7drmEms_NldeU"
                        );
                    if (app_name == "page_grader") {
                        restDomain =
                            `v2/ninjaseo/domain/page_graders?${this.timeFormat()}and domain_url like '${domain}%'`;
                    } else if (app_name == "rankings") {
                        restDomain = `v2/ninjaseo/domain/rankings?${this.timeFormat()}and url='${domain}'`;
                    } else if (app_name === 'support') {
                        restDomain =
                            `v2/support/domain/ticket_details?${this.timeFormat()}and group_id = '${domain}%'`;
                    } else {
                        restDomain =
                            `v2/ninjaseo/domain/link_trackings?${this.timeFormat()} and site_url='${domain}'`;
                    }
                    let host_name = window.location.href.includes("env=dev") ? "https://api.dev.500apps.com" :
                        "https://api.ap1.500apps.com"; //Set host
                    fetch(`${host_name}/${restDomain}`, {
                        method: "GET",
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json",
                            authorization: `Bearer ${token}`,
                        },
                    })
                        .then(function (response) {
                            return response.json();
                        })
                        .then((data) => {
                            if (app_name == 'support') {
                                this.$nextTick(() => {
                                    this.supportTableData.push({
                                        data
                                    })
                                })
                            } else {
                                this.seoTableData[app_name].push(data);
                                this.seoURLsData[app_name] = this.seoURLsData[app_name].filter((item) =>
                                    item.name !== domain);
                            }
                        });
                },
                timeFormat() {
                    const self = this;
                    return `where=date(created_date) between '${self.fromDate}' and '${moment(self.toDate).format("YYYY-MM-DD")}'`;
                },
                displaySEOList(data, type) {
                    const self = this;
                    self.seoPageType = type;
                    self.loadContentData = true;
                    self.hideContentURlsList = false;
                    self.contentUrls = [];
                    let token;
                    window.location.href.includes("env=dev") ?
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InNyYXZhbmkuc2V0dGlwYWxsaStsb2NhbEA1MDBhcHBzLmNvbSIsInRlbmFudF9pZCI6Mjg0MSwidXNlcl9pZCI6NzgyMywic3Vic2NyaWJlZCI6InllcyIsImV4cCI6IjE2NTA2MTgxOTciLCJlbnYiOiJkZXYifQ.I6CZ6k3TwLLGnuYC4tiNbLiP3vYh0Jjocz2NQ4siLmM"
                        ) :
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InJhd2liYWJidS5kYWtvanVANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjEzNDE2LCJ1c2VyX2lkIjoxODQxMSwic3Vic2NyaWJlZCI6Im5vIiwiZXhwIjoiMTY1MjEwNzczNyIsImVudiI6ImFwMSJ9.eFL8jtuSsupX2lAdewU0-VZvedA_CB7drmEms_NldeU"
                        );

                    if (type == "page_grader") {
                        restDomain =
                            `v2/ninjaseo/domain/page_graders?${this.timeFormat()} and domain_url='${data.data.website_url}'`;
                    } else if (type == "rankings") {
                        restDomain =
                            `v2/ninjaseo/domain/rankings?${this.timeFormat()} and url='${data.data.website_url}'`;
                    } else {
                        restDomain =
                            `v2/ninjaseo/domain/link_trackings?${this.timeFormat()} and site_url='${data.data.website_url}'`;
                    }

                    let host_name = window.location.href.includes("env=dev") ? "https://api.dev.500apps.com" :
                        "https://api.ap1.500apps.com"; //Set host

                    fetch(`${host_name}/${restDomain}`, {
                        method: "GET",
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json",
                            authorization: `Bearer ${token}`,
                        },
                    })
                        .then(function (response) {
                            return response.json();
                        })
                        .then(function (data) {
                            self.loadContentData = false;
                            self.contentUrls = data;
                            self.hideContentURlsList = true;
                        });
                },
                getTableFields(app_name) {
                    self = this;
                    if (app_name === "page_grader") return self.pageGraderFields;
                    else if (app_name === "rankings") return self.rankingsFields;
                    else if (app_name == "departments") return self.chatFields;
                    else if (app_name == "missedChats") return self.contactFields;
                    else return self.linkTrackingFields;
                },
                showHistory(data, type) {
                    const self = this;
                    self.resetHistory();
                    if (self.seoPageType === "page_grader") {
                        let host_name = window.location.href.includes("env=dev") ?
                            "https://api.dev.500apps.com" : "https://api.ap1.500apps.com"; //Set host
                        let token;
                        window.location.href.includes("env=dev") ?
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InNyYXZhbmkuc2V0dGlwYWxsaStsb2NhbEA1MDBhcHBzLmNvbSIsInRlbmFudF9pZCI6Mjg0MSwidXNlcl9pZCI6NzgyMywic3Vic2NyaWJlZCI6InllcyIsImV4cCI6IjE2NTA2MTgxOTciLCJlbnYiOiJkZXYifQ.I6CZ6k3TwLLGnuYC4tiNbLiP3vYh0Jjocz2NQ4siLmM"
                            ) :
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InJhd2liYWJidS5kYWtvanVANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjEzNDE2LCJ1c2VyX2lkIjoxODQxMSwic3Vic2NyaWJlZCI6Im5vIiwiZXhwIjoiMTY1MjEwNzczNyIsImVudiI6ImFwMSJ9.eFL8jtuSsupX2lAdewU0-VZvedA_CB7drmEms_NldeU"
                            );
                        fetch(
                            `${host_name}/v2/ninjaseo/domain/page_grader_history?where=page_grader_id="${data.id}"&&order_by=created_date desc`, {
                            method: "GET",
                            headers: {
                                Accept: "application/json",
                                "Content-Type": "application/json",
                                authorization: `Bearer ${token}`,
                            },
                        })
                            .then(function (response) {
                                return response.json();
                            })
                            .then(function (data) {
                                self.pageGraderHistory = data;
                            });
                    } else if (self.seoPageType === "rankings") {
                        if (data.history) self.rankingHistory = data;
                    } else {
                        if (type === "notes" || type === "activities") {
                            let host_name = window.location.href.includes("env=dev") ?
                                "https://api.dev.500apps.com" : "https://api.ap1.500apps.com"; //Set host
                            let token;
                            window.location.href.includes("env=dev") ?
                                (token =
                                    "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InNyYXZhbmkuc2V0dGlwYWxsaStsb2NhbEA1MDBhcHBzLmNvbSIsInRlbmFudF9pZCI6Mjg0MSwidXNlcl9pZCI6NzgyMywic3Vic2NyaWJlZCI6InllcyIsImV4cCI6IjE2NTA2MTgxOTciLCJlbnYiOiJkZXYifQ.I6CZ6k3TwLLGnuYC4tiNbLiP3vYh0Jjocz2NQ4siLmM"
                                ) :
                                (token =
                                    "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InJhd2liYWJidS5kYWtvanVANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjEzNDE2LCJ1c2VyX2lkIjoxODQxMSwic3Vic2NyaWJlZCI6Im5vIiwiZXhwIjoiMTY1MjEwNzczNyIsImVudiI6ImFwMSJ9.eFL8jtuSsupX2lAdewU0-VZvedA_CB7drmEms_NldeU"
                                );
                            fetch(
                                `${host_name}/v2/ninjaseo/domain/link_tracking_${type}?where=link_tracking_id="${data.id}" ${type === "notes" ? 'and note<>""' : ""}&&order_by=created_date desc`, {
                                method: "GET",
                                headers: {
                                    Accept: "application/json",
                                    "Content-Type": "application/json",
                                    authorization: `Bearer ${token}`,
                                },
                            })
                                .then(function (response) {
                                    return response.json();
                                })
                                .then(function (data) {
                                    if (type === "notes") self.linkTrackingNotes = data;
                                    else self.linkTrackingActivities = data;
                                });
                        }
                    }
                },
                resetHistory() {
                    const self = this;
                    self.pageGraderHistory = [];
                    self.rankingHistory = {};
                    self.linkTrackingNotes = [];
                    self.linkTrackingActivities = [];
                },
                async getUserName(id) {
                    if (this.this.userNamesData[id]) return this.userNamesData[id];
                    else {
                        var userDetails = await this.getUserData(id);
                        this.userNamesData[id] = userDetails[0].name;
                        return userDetails[0].name;
                    }
                },
                getUserData(id) {
                    return new Promise((resolve) => {
                        let host_name = window.location.href.includes("env=dev") ?
                            "https://api.dev.500apps.com" : "https://api.ap1.500apps.com"; //Set host
                        let token;
                        window.location.href.includes("env=dev") ?
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InByaXlhZGFyc2hpbmkuZGFsYWlANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjM3MzMsInVzZXJfaWQiOjEzNDE0LCJleHAiOiIxNjk3MDI1ODg3IiwiZW52IjoiZGV2In0.0VCh8VtCIuJZwuLGtMYI1dJX9RppgXK4yaG4Pb2FM2g"
                            ) :
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InBoYW5lZW5kcmEua3VtYXJANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjEzNDE2LCJ1c2VyX2lkIjoxODQ2NCwiZXhwIjoiMTcxMDA1ODU4NCIsImVudiI6ImFwMSJ9.Z4eRRyjiL8qqjuYfr4CHupL5mzEaZgDsddC0ErxCHso"
                            );
                        fetch(`${host_name}/v2/users/domain/domain_user?where=is_active=1`, {
                            method: "GET",
                            headers: {
                                Accept: "application/json",
                                "Content-Type": "application/json",
                                authorization: `Bearer ${token}`,
                            },
                        })
                            .then(function (response) {
                                return response.json();
                            })
                            .then((data) => {
                                resolve(data);
                                window.Users = data
                            });
                    });
                },
                getSEOStatistics(type, domainCount) {
                    if (type === "page_grader" || type === "link_tracking") return;
                    let self = this;
                    let host_name = window.location.href.includes("env=dev") ? "https://api.dev.500apps.com" :
                        "https://api.ap1.500apps.com"; //Set host
                    let token;
                    window.location.href.includes("env=dev") ?
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InJhaHVsLnZhbmFnYXJpQDUwMGFwcHMuY29tIiwidGVuYW50X2lkIjoyOTQ4LCJ1c2VyX2lkIjo4MjY2LCJzdWJzY3JpYmVkIjoibm8iLCJleHAiOiIxNjUyMDkzMzc5IiwiZW52IjoiZGV2In0.r_o6kkhn5nqCtTVd-EdgKYLnIpr4y9Xchvp444cLmGE"
                        ) :
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InJhd2liYWJidS5kYWtvanVANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjEzNDE2LCJ1c2VyX2lkIjoxODQxMSwic3Vic2NyaWJlZCI6Im5vIiwiZXhwIjoiMTY1MjEwNzczNyIsImVudiI6ImFwMSJ9.eFL8jtuSsupX2lAdewU0-VZvedA_CB7drmEms_NldeU"
                        );
                    if (type === "rankings") var restDomain =
                        `/v2/ninjaseo/domain/rankings?fields=keyword_position as rank&${self.timeFormat()}`;
                    else if (type === "keywords_count") restDomain =
                        `/v2/ninjaseo/domain/rankings?fields=count(distinct keyword_position) as keyword_count&${self.timeFormat()}`;
                    fetch(`${host_name}${restDomain}`, {
                        method: "GET",
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json",
                            authorization: `Bearer ${token}`,
                        },
                    })
                        .then(function (response) {
                            return response.json();
                        })
                        .then(function (data) {
                            if (type === "rankings") {
                                data.forEach((item) => {
                                    if (item.rank === "Not in first 100.") return;
                                    if (parseInt(item.rank) < 100) self.seoStatistics.below_100
                                        .push(item);
                                    if (parseInt(item.rank) < 50) self.seoStatistics.below_50.push(
                                        item);
                                    if (parseInt(item.rank) < 25) self.seoStatistics.below_25.push(
                                        item);
                                    if (parseInt(item.rank) < 10) self.seoStatistics.below_10.push(
                                        item);
                                    if (parseInt(item.rank) < 5) self.seoStatistics.below_5.push(
                                        item);
                                });
                            } else if ((type = "keywords_count")) {
                                self.RankingsKeywordCount = data[0].keyword_count;
                            }
                            self.RankingsDomainCount = domainCount;
                        });
                },
                getAppLogo(app_name, data) {
                    var url = new URL(app_name === "page_grader" ? data.domain_url : app_name === "rankings" ?
                        data.url : data.site_url);
                    return `https://infinity.500apps.com/img/logos/${url.host.split(".")[0]}.svg`;
                },
                getAppName(app_name, data) {
                    var url = new URL(app_name === "page_grader" ? data.domain_url : app_name === "rankings" ?
                        data.url : data.site_url);
                    return url.host;
                },
                getPercentage(value) {
                    return parseFloat((value.length / this.RankingsDomainCount) * 100).toFixed(2);
                },
                /**
                 * Compares last two position history and return status
                 * @param {object} data details of the keyword
                 */
                positionStatus(data) {
                    if (data.history) {
                        const historyList = JSON.parse(data.history);
                        const historyLength = historyList.length;
                        if (historyLength > 1) {
                            const previous_history = historyList[1].history; // get previous history position
                            const present_history = historyList[0].history; // get latest history positon
                            if (previous_history && present_history) {
                                var status =
                                    // Compare if both previous and present positions are numeric data type
                                    typeof present_history == "number" && typeof previous_history == "number" ?
                                        previous_history > present_history ?
                                            "increased" :
                                            previous_history < present_history ?
                                                "decreased" :
                                                "" : // Compare when present and previous history is either numeric or string data type
                                        typeof present_history == "string" && typeof previous_history == "number" ?
                                            "decreased" :
                                            typeof present_history == "number" && typeof previous_history == "string" ?
                                                "increased" :
                                                "";
                                if (typeof previous_history == "number" && typeof present_history == "number") {
                                    if (status == "increased")
                                        return `${status} by ${previous_history - present_history}`;
                                    else if (status == "decreased")
                                        return `${status} by ${present_history - previous_history}`;
                                    else return "";
                                } else return `${status}`;
                            }
                        }
                    }
                },

                onScroll(event, appName) {
                    if (event.target.scrollTop + event.target.clientHeight >= event.target.scrollHeight && this
                        .seoURLsData[appName].length) {
                        this.seoURLsData[appName].forEach((item, index) => {
                            if (index < this.scrollCount) {
                                try {
                                    this.getSEOTableData(appName, item.name);
                                } catch (err) {
                                    console.log(err);
                                }
                            }
                        });
                    }
                },

                async showNinjachatReports() {
                    const self = this;
                    self.isBusy = true;
                    self.emptyState = true;
                    self.hideDepartments = false;
                    self.hideAgents = false;
                    self.hideMissedChats = false;
                    self.ninjaChatList.map((content_type, index) => {
                        let restDomain;
                        let token;
                        window.location.href.includes("env=dev") ?
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InNvd215YS5sYXZldGlANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjIxNTksInVzZXJfaWQiOjgwNjEsInN1YnNjcmliZWQiOiJubyIsImV4cCI6IjE2NTE5MjU0ODAiLCJlbnYiOiJkZXYifQ.RTx48w4CFUM6bbrULmFkHJUUApzYWxmu3NzFoRB9nXc"
                            ) :
                            (token =
                                "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6Imphc29uQDUwMGFwcHMuY29tIiwidGVuYW50X2lkIjoxMzQxNiwidXNlcl9pZCI6MTg0MTUsInN1YnNjcmliZWQiOiJubyIsImV4cCI6IjE2NTA4NzA5NDgiLCJlbnYiOiJhcDEifQ.8XtE3S25cJWMQMoMnEXrEXo8_wb2dpDTaFa9valZ3bE"
                            );
                        if (content_type.value == "departments") {
                            restDomain = `v2c/ninjachat/get_department_details`;
                        }
                        if (content_type.value == "agents") {
                            restDomain = `v2c/ninjachat/get_agent_details`;
                        }
                        if (content_type.value == "missedChats") {
                            restDomain = `v2c/ninjachat/get_missed_count`;
                        }
                        let host_name = window.location.href.includes("env=dev") ?
                            "https://api.dev.500apps.com" :
                            "https://api.ap1.500apps.com"; //Set host

                        fetch(`${host_name}/${restDomain}`, {
                            method: "POST",
                            body: JSON.stringify({
                                where: `${this.timeFormat().replace("where=date(created_date)", "date(cd.created_date)")}`,
                            }),
                            headers: {
                                Accept: "application/json",
                                "Content-Type": "application/json",
                                authorization: `Bearer ${token}`,
                            },
                        })
                            .then(function (response) {
                                return response.json();
                            })
                            .then(function (data) {
                                self.emptyState = false;
                                self.isBusy = false;
                                if (data.length == 0) {
                                    self.emptyState = true;
                                    if (content_type.value == "departments") self
                                        .hideDepartments = true;
                                    else if (content_type.value == "agents") self.hideAgents =
                                        true;
                                    else self.hideMissedChats = true;
                                    return;
                                }

                                var dataSet = [];
                                var totalSignupCount = 0;
                                data.filter((item) => {
                                    totalSignupCount = totalSignupCount + parseInt(item
                                        .count);
                                    dataSet.push({
                                        name: item.show_name,
                                        y: parseInt(item.count),
                                        data: item
                                    });
                                });
                                var reportData = {
                                    totalSignupCount: totalSignupCount,
                                    reportData: dataSet
                                };
                                self.generateReportByType(`ninjachat-${content_type.value}`,
                                    reportData, totalSignupCount);
                                dataSet.forEach(async (item) => {
                                    try {
                                        await self.getNinjachatTableData(
                                            content_type.value, item, item.data
                                            .show_name);
                                    } catch (err) {
                                        console.log(err)
                                    }
                                });
                            });
                    });
                },

                /**
                 * To display the details of chat transcript
                 * @param {id} contactID To get the respective contact id
                 * @param {string} chatInfo To get the respective chat history
                 */
                async chatTranscript(chatInfo) {
                    setTimeout(() => {
                        this.$root.$emit("bv::toggle::collapse",
                            `transcript_slideout-${chatInfo.contact_id}`);
                    }, 200);
                    this.chatInfo = chatInfo;
                },

                // Format chat transcript
                formatData() {
                    return this.chatInfo.chat_history ? JSON.parse(this.chatInfo.chat_history) : [];
                },
                /**
                 * Get the duration of the chat
                 * @param {Array} chatInfo Get the respective chat history
                 */
                getMessageDuration(chatInfo) {
                    if (!chatInfo) return;
                    var chatResponse = JSON.parse(chatInfo);
                    var firstMessage = chatResponse[0].to ? chatResponse[0].to.time : chatResponse[0].from.time;
                    var lastMessage = chatResponse[chatResponse.length - 1].to ? chatResponse[chatResponse
                        .length - 1].to.time : chatResponse[chatResponse.length - 1].from.time;
                    var minutesDiff = moment().diff(moment(firstMessage), "minutes") - moment().diff(moment(
                        lastMessage), "minutes");
                    var duration = minutesDiff < 0 ? -minutesDiff : minutesDiff;
                    return duration;
                },

                /**
                 * Change chat transcripts when user triggers prev and next button
                 * @param {Array} chatInfo Get the respective chat data
                 * @param {String} type type selected(prev/next)
                 */
                async changeChatTranscripts(chatInfo, type, chats) {
                    var data = chats[0].filter((item) => {
                        return item.id == chatInfo.id;
                    });
                    var row_index = chats[0].indexOf(data[0]);
                    type == "next" ? (row_index = row_index + 1) : (row_index = row_index - 1);
                    if (row_index == chats[0].length) return (this.disabledNext = true);
                    else if (row_index == -1) return (this.disabledPrev = true);
                    this.disabledNext = false;
                    this.disabledPrev = false;
                    this.chatInfo = chats[0][row_index];
                },

                // Get device type and browser of read recipient
                getBrowserType(device_type) {
                    if (device_type == "Chrome") {
                        return "https://infinity.500apps.com/img/chrome.png";
                    }
                    if (device_type == "Firefox") {
                        return "https://infinity.500apps.com/img/firefox.png";
                    }
                },

                getOSType(device_type) {
                    if (device_type == "Linux") {
                        return "https://infinity.500apps.com/img/flags/linux_os.png";
                    }
                    if (device_type == "Windows") {
                        return "https://infinity.500apps.com/img/flags/windows_os.png";
                    }
                },
                getDeviceType(device_type) {
                    if (device_type == "Desktop") {
                        return "desktop";
                    }
                    if (device_type == "Mobile") {
                        return "mobile";
                    }
                },
                getCountry(device_type) {
                    if (device_type == "India") {
                        return "bg-IN";
                    }
                },

                /**
                 * To display the details of chat transcript
                 * @param {id} contactID To get the respective contact id
                 * @param {string} chatInfo To get the respective chat history
                 */
                async showFeedback(chatInfo) {
                    setTimeout(() => {
                        this.$root.$emit("bv::toggle::collapse",
                            `feedback_slideout-${chatInfo.contact_id}`);
                    }, 400);
                    this.chatInfo = chatInfo;
                    this.feedbackResponse = JSON.parse(chatInfo.response);
                },

                async getNinjachatTableData(app_name, domain, name) {
                    this.ninjaChatList[2].text = "";
                    if (app_name == "agents") return;
                    let restDomain;
                    let token;
                    window.location.href.includes("env=dev") ?
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InNvd215YS5sYXZldGlANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjIxNTksInVzZXJfaWQiOjgwNjEsInN1YnNjcmliZWQiOiJubyIsImV4cCI6IjE2NTE5MjU0ODAiLCJlbnYiOiJkZXYifQ.RTx48w4CFUM6bbrULmFkHJUUApzYWxmu3NzFoRB9nXc"
                        ) :
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6Imphc29uQDUwMGFwcHMuY29tIiwidGVuYW50X2lkIjoxMzQxNiwidXNlcl9pZCI6MTg0MTUsInN1YnNjcmliZWQiOiJubyIsImV4cCI6IjE2NTA4NzA5NDgiLCJlbnYiOiJhcDEifQ.8XtE3S25cJWMQMoMnEXrEXo8_wb2dpDTaFa9valZ3bE"
                        );
                    if (app_name == "departments") {
                        restDomain =
                            `v2/ninjachat/domain/chat_details?${this.timeFormat()}and department_id like '${domain.data.id}%'`;
                    }
                    if (app_name == "missedChats") {
                        restDomain =
                            `v2/ninjachat/domain/agent_contact_details?${this.timeFormat()}and department_id like '${domain.data.id}%'`;
                    }
                    let host_name = window.location.href.includes("env=dev") ?
                        "https://api.dev.500apps.com" : "https://api.ap1.500apps.com"; //Set host
                    fetch(`${host_name}/${restDomain}`, {
                        method: "GET",
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json",
                            authorization: `Bearer ${token}`,
                        },
                    })
                        .then(function (response) {
                            return response.json();
                        })
                        .then((data) => {
                            data["show_message"] = data;
                            data["lines"] = data;
                            data["duration"] = data;
                            data["show_name"] = name;
                            this.ninjachatTableData[app_name].push(data);
                        });
                },

                async showSupportReports() {
                    const self = this;
                    self.isBusy = true;
                    self.emptyState = true;
                    self.hideGroups = false;
                    let restDomain;
                    let token;
                    window.location.href.includes("env=dev") ?
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InNhaXJhbS5zdW5rYXJhQDUwMGFwcHMuY29tIiwidGVuYW50X2lkIjo0Nzg1LCJ1c2VyX2lkIjoxNTI5Nywic3Vic2NyaWJlZCI6Im5vIiwiZXhwIjoiMTY1MTgzNzIwNyIsImVudiI6ImRldiJ9.eniUdqbsnMtKdJJV36Pmz4upEQc-Yp4CHHGhp2mW-r4"
                        ) :
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6Imphc29uQDUwMGFwcHMuY29tIiwidGVuYW50X2lkIjoxMzQxNiwidXNlcl9pZCI6MTg0MTUsInN1YnNjcmliZWQiOiJubyIsImV4cCI6IjE2NTA4NzA5NDgiLCJlbnYiOiJhcDEifQ.8XtE3S25cJWMQMoMnEXrEXo8_wb2dpDTaFa9valZ3bE"
                        );

                    restDomain = `v2c/support/get_tickets_data`;
                    let host_name = window.location.href.includes("env=dev") ?
                        "https://api.dev.500apps.com" : "https://api.ap1.500apps.com"; //Set host

                    let response = await fetch(`${host_name}/${restDomain}`, {
                        method: "POST",
                        body: JSON.stringify({
                            where: `${this.timeFormat().replace("where=", "")}`,
                        }),
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json",
                            authorization: `Bearer ${token}`,
                        },
                    });
                    let data = await response.json()
                    self.supportTokenData = [...data]
                    self.emptyState = false;
                    self.isBusy = false;
                    this.$nextTick(() => {
                        data.forEach((item) => {
                            var dataSet = JSON.parse(`[${item.ticket_status}]`)
                            dataSet = dataSet.map(item => ({
                                name: Object.keys(item)[0],
                                y: item[`${Object.keys(item)[0]}`]
                            }))
                            var reportData = {
                                totalSignupCount: parseInt(item.total_tickets),
                                reportData: dataSet,
                                name: item.group_name
                            };
                            self.generateReportByType(`support-${item.group_id}`,
                                reportData, totalSignupCount);
                            self.getSEOTableData('support', item.group_id)
                        })
                    })
                },

                async get_goals(project_ids, callback) {
                    const self = this;
                    let host_name = window.location.href.includes("env=dev") ?
                        "https://projects.dev.500apps.com" : "https://projects.ap1.500apps.com";
                    let restDomain;
                    let token;
                    let unique_goals = {};
                    window.location.href.includes("env=dev") ?
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InByaXlhZGFyc2hpbmkuZGFsYWlANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjM3MzMsInVzZXJfaWQiOjEzNDE0LCJleHAiOiIxNjk3MDI1ODg3IiwiZW52IjoiZGV2In0.0VCh8VtCIuJZwuLGtMYI1dJX9RppgXK4yaG4Pb2FM2g"
                        ) :
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InBoYW5lZW5kcmEua3VtYXJANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjEzNDE2LCJ1c2VyX2lkIjoxODQ2NCwiZXhwIjoiMTcxMDA1ODU4NCIsImVudiI6ImFwMSJ9.Z4eRRyjiL8qqjuYfr4CHupL5mzEaZgDsddC0ErxCHso"
                        );
                    restDomain = `v2/milestones?where=project_id in (${project_ids})`;
                    fetch(`${host_name}/${restDomain}`, {
                        method: "GET",
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json",
                            authorization: `Bearer ${token}`,
                        },
                    })
                        .then(function (response) {
                            return response.json();
                        })
                        .then(function (data) {
                            self.goals_array = [...data];
                            self.goals = data.reduce((unique, item) => (unique.includes(item.name) ?
                                unique : [...unique, item.name]), [{
                                    name: "All",
                                    id: ""
                                }]);
                            callback();
                        });
                },
                async show_projectsly_reports() {
                    await this.tab_clicked;
                },
                async tab_clicked(index) {
                    this.goal = "All";
                    this.goals = [];
                    let project_ids = this.teams[index].project_id;
                    await this.get_goals(project_ids, this.get_goals_by_tasks);
                },
                async get_goals_by_tasks() {
                    let filtered_goals = [];
                    let milestone_ids = this.goals_array
                        .filter((goal) => {
                            if (this.goal != "All") return goal.name == this.goal;
                            else return goal;
                        })
                        .map((item) => {
                            return item.id;
                        })
                        .join(",");
                    let token;
                    window.location.href.includes("env=dev") ?
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InByaXlhZGFyc2hpbmkuZGFsYWlANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjM3MzMsInVzZXJfaWQiOjEzNDE0LCJleHAiOiIxNjk3MDI1ODg3IiwiZW52IjoiZGV2In0.0VCh8VtCIuJZwuLGtMYI1dJX9RppgXK4yaG4Pb2FM2g"
                        ) :
                        (token =
                            "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6InBoYW5lZW5kcmEua3VtYXJANTAwYXBwcy5jb20iLCJ0ZW5hbnRfaWQiOjEzNDE2LCJ1c2VyX2lkIjoxODQ2NCwiZXhwIjoiMTcxMDA1ODU4NCIsImVudiI6ImFwMSJ9.Z4eRRyjiL8qqjuYfr4CHupL5mzEaZgDsddC0ErxCHso"
                        );
                    let host_name = window.location.href.includes("env=dev") ?
                        "https://projects.dev.500apps.com" : "https://projects.ap1.500apps.com"; //Set host
                    this.projectsly_incomplete_tasks = await this.GetTaskIncompleteData(milestone_ids,
                        host_name, token);
                    this.assignee_incomplete_tasks = await this.GetAssigneeData(milestone_ids, host_name,
                        token);
                    this.projectsly_completed_tasks = await this.GetTaskCompleteData(milestone_ids,
                        host_name, token);
                    this.assignee_completed_tasks = await this.GetAssigneeTasks(milestone_ids, host_name,
                        token);
                    // this.projectsly_table_items = this.assignee_incomplete_tasks.map((item, i) => Object.assign({}, item, this.assignee_completed_tasks[i]));
                    this.assignee_incomplete_tasks.filter((task) => {
                        let user_found = this.assignee_completed_tasks.find((item) => task
                            .assignee_id == item.assignee_id);
                        task.completed_count = user_found ? user_found.complete_count : 0;
                        task.completed_hrs = user_found ? user_found.total_completed_hrs : 0;
                    });
                    this.assignee_incomplete_tasks = [...this.assignee_incomplete_tasks];

                    this.total_user_tasks = this.assignee_incomplete_tasks.length;
                },
                async GetAssigneeTasks(milestone_ids, host_name, token) {
                    let restDomain =
                        `v2/tasks?where=milestone_id in (${milestone_ids}) and status_id=3&fields=count(id)%20as%20complete_count,assignee_id,sum(estimated_hours) as total_completed_hrs&group_by=assignee_id`;
                    let data = await this.get_data(host_name, restDomain, token);
                    return data;
                },
                async GetTaskCompleteData(milestone_ids, host_name, token) {
                    let restDomain =
                        `v2/tasks?where=milestone_id in (${milestone_ids}) and status_id=3&fields=count(id)%20as%20complete_count,assignee_id,sum(estimated_hours) as total_completed_hrs`;
                    let data = await this.get_data(host_name, restDomain, token);
                    return data;
                },
                async GetAssigneeData(milestone_ids, host_name, token) {
                    let restDomain =
                        `v2/tasks?where=milestone_id in (${milestone_ids})&fields=count(id)%20as%20count,assignee_id,sum(estimated_hours) as total_est_hrs&group_by=assignee_id`;
                    let data = await this.get_data(host_name, restDomain, token);
                    return data;
                },
                async GetTaskIncompleteData(milestone_ids, host_name, token) {
                    let restDomain =
                        `v2/tasks?where=milestone_id in (${milestone_ids})&fields=count(id)%20as%20count,assignee_id,sum(estimated_hours) as total_est_hrs`;
                    let data = await this.get_data(host_name, restDomain, token);
                    return data;
                },
                async get_data(host_name, restDomain, token) {
                    let response = await fetch(`${host_name}/${restDomain}`, {
                        method: "GET",
                        headers: {
                            Accept: "application/json",
                            "Content-Type": "application/json",
                            authorization: `Bearer ${token}`,
                        },
                    });
                    let data = await response.json();
                    return data;
                },

                get_user_name(id) {
                    return window.Users.find((user) => user.id == id).name;
                },
            },
        });
    </script>
</body>

</html>